<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>web安全 | 技术博客，知识分享，学习笔记，问题解决方案</title>
    <meta name="description" content="啊郭的博客">
    <link rel="stylesheet" href="/guo-notes/assets/style.5e0eda6f.css">
    <link rel="modulepreload" href="/guo-notes/assets/app.a231f820.js">
    <link rel="modulepreload" href="/guo-notes/assets/classify_面试常问_web安全.md.068eca72.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c6a644e1><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c6a644e1 data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-6f1d18b5><div class="container" data-v-6f1d18b5><div class="VPNavBarTitle has-sidebar" data-v-6f1d18b5 data-v-d5925166><a class="title" href="/guo-notes/" data-v-d5925166><!--[--><!--]--><!----><!--[-->啊郭的博客<!--]--><!--[--><!--]--></a></div><div class="content" data-v-6f1d18b5><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6f1d18b5 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 后端技术 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/Redis/redis%E4%BB%8B%E7%BB%8D.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Redis<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/mysql/mysql%E4%BB%8B%E7%BB%8D.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Mysql<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/RabbitMQ/MQ%E7%9A%84%E6%A6%82%E5%BF%B5.html" data-v-e8e0fb1d data-v-3c355974><!--[-->RabbitMq<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/Docker/Docker%E4%BB%8B%E7%BB%8D.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Docker<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/Kubernetes/Kubernetes%E4%BB%8B%E7%BB%8D.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Kubernetes<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/Kafka/kafka%E4%BB%8B%E7%BB%8D.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Kafka<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 计算机基础 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/guo-notes/classify/计算机基础/计算机网络/" data-v-e8e0fb1d data-v-3c355974><!--[-->计算机网络<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guo-notes/classify/algorithm/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->算法<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 杂项 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6f1d18b5 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-a3e7452b data-v-1899cd41 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1899cd41><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1899cd41><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6f1d18b5 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/gyh-up?tab=repositories" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink" href="https://blog.csdn.net/weixin_42258523?spm=1000.2115.3001.5343" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><embed src="https://g.csdnimg.cn/static/logo/favicon32.ico" style="border-radius: 100%;width: 20px;height: 20px;" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6f1d18b5 data-v-e4361c82 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e4361c82><div class="item appearance" data-v-e4361c82><p class="label" data-v-e4361c82>Appearance</p><div class="appearance-action" data-v-e4361c82><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-e4361c82 data-v-1899cd41 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-1899cd41><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-1899cd41><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e4361c82><div class="item social-links" data-v-e4361c82><div class="VPSocialLinks social-links-list" data-v-e4361c82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/gyh-up?tab=repositories" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink" href="https://blog.csdn.net/weixin_42258523?spm=1000.2115.3001.5343" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><embed src="https://g.csdnimg.cn/static/logo/favicon32.ico" style="border-radius: 100%;width: 20px;height: 20px;" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6f1d18b5 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-c6a644e1 data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-c6a644e1 data-v-f332cb62><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f332cb62><span class="visually-hidden" id="sidebar-aria-label" data-v-f332cb62> Sidebar Navigation </span><!--[--><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-35f99ef5><div class="title" role="button" data-v-35f99ef5><h2 class="title-text" data-v-35f99ef5>面试常问</h2><div class="action" data-v-35f99ef5><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-35f99ef5><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-35f99ef5><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-35f99ef5><!--[--><!--[--><a class="VPLink link link active" href="/guo-notes/classify/%E9%9D%A2%E8%AF%95%E5%B8%B8%E9%97%AE/web%E5%AE%89%E5%85%A8.html" style="padding-left:0px;" data-v-2cfe069a data-v-3c355974><!--[--><span class="link-text" data-v-2cfe069a>web安全</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/guo-notes/classify/%E9%9D%A2%E8%AF%95%E5%B8%B8%E9%97%AE/%E4%B8%80%E6%AC%A1%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E5%AE%8C%E6%95%B4%E8%BF%87%E7%A8%8B.html" style="padding-left:0px;" data-v-2cfe069a data-v-3c355974><!--[--><span class="link-text" data-v-2cfe069a>一次网络请求的完整过程</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c6a644e1 data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-37ebe389><div class="container" data-v-37ebe389><div class="aside" data-v-37ebe389><div class="aside-curtain" data-v-37ebe389></div><div class="aside-container" data-v-37ebe389><div class="aside-content" data-v-37ebe389><div class="VPDocAside" data-v-37ebe389 data-v-afc4c1a1><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-afc4c1a1 data-v-2865c0b0><div class="content" data-v-2865c0b0><div class="outline-marker" data-v-2865c0b0></div><div class="outline-title" data-v-2865c0b0>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-2865c0b0><span class="visually-hidden" id="doc-outline-aria-label" data-v-2865c0b0> Table of Contents for current page </span><ul class="root" data-v-2865c0b0 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-afc4c1a1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-37ebe389><div class="content-container" data-v-37ebe389><!--[--><!--]--><main class="main" data-v-37ebe389><div style="position:relative;" class="vp-doc _guo-notes_classify_%E9%9D%A2%E8%AF%95%E5%B8%B8%E9%97%AE_web%E5%AE%89%E5%85%A8" data-v-37ebe389><div><h1 id="web安全" tabindex="-1">web安全 <a class="header-anchor" href="#web安全" aria-hidden="true">#</a></h1><p>对已知问题有有效的解决方案，对未知/潜在问题建立发现和防御机制。对于安全问题，**首先要提高安全意识，建立一个安全的有效机制，从政策层面，组织层面进行保障，比如服务器密码不能泄露，密码每月更新，并且三次内不能重复；每周安全扫描等。**以制度化的方式，加强安全体系的建设。同时，需要注意与安全有关的各个环节。安全问题不容忽视，包括基础设施安全，应用系统安全，数据保密安全等。</p><ul><li>基础设施安全：硬件采购，操作系统，网络环境方面的安全。一般采用正规渠道购买高质量的产品，选择安全的操作系统，及时修补漏洞，安装杀毒软件防火墙。防范病毒，后门。设置防火墙策略，建立 DDOS 防御系统，使用攻击检测系统，进行子网隔离等手段。</li><li>应用系统安全：在程序开发时，对已知常用问题，使用正确的方式，在代码层面解决掉。防止跨站脚本攻击（XSS），注入攻击，跨站请求伪造（CSRF），错误信息，HTML注释，文件上传，路径遍历等。还可以使用Web应用防火墙（比如：ModSecurity），进行安全漏洞扫描等措施，加强应用级别的安全。</li><li>数据保密安全：存储安全（存储在可靠的设备，实时，定时备份），保存安全（重要的信息加密保存，选择合适的人员负责保存和检测等），传输安全（防止数据窃取和数据篡改）；</li></ul><p>常用的加解密算法（单项散列加密[MD5、SHA]，对称加密[DES、3DES、RC]），非对称加密[RSA]等。</p><h2 id="一、centos-安全" tabindex="-1">一、centos 安全 <a class="header-anchor" href="#一、centos-安全" aria-hidden="true">#</a></h2><h2 id="_1、端口" tabindex="-1">1、端口 <a class="header-anchor" href="#_1、端口" aria-hidden="true">#</a></h2><p>只开放必要的端口，如80端口，其它端口都是限制连接条件。</p><p>比如：3306，22，6379，肯定要指定内部 ip，不要用常规端口号。</p><h2 id="_2、堡垒机" tabindex="-1">2、堡垒机 <a class="header-anchor" href="#_2、堡垒机" aria-hidden="true">#</a></h2><p>那么简单来说，堡垒机的核心价值就是用来解决**“运维权限混乱，操作无审计”**的问题。当我们的公司运维人员越来越多，所需要管理的主机资源也越来越多时，管理跟技术手段不到位所带来的运维安全风险也越来越高，这个时候我们应该怎么做呢？</p><ul><li>首先，在事前，我们需要规定用户所能访问资源的权限，使权限实现最小化 打个比方，我们把主机资源看作是一个房子，那我们的运维人员就是一个客人，普通客人只能在我们里面客厅活动，如果说他要进入卧室，那需要主人的同意。</li><li>第二，在事中的时候，我们需要实时监控我们运维人员的操作，一旦发现有危险操作时可以进行阻断。就好比，在房间里面装了一个“摄像头”，我们可以看到客人在房间里面的一举一动。</li><li>事后，我们需要追溯溯源，还原事故现场；客人在“房间”里的一举一动，都会被录制下来，方便回放查看。</li></ul><p>政府、企业，以及其他各行各业都会面临着运维安全风险：</p><ul><li><strong>来源身份定位难：</strong> 当多个运维人员使用相同的账号对主机进行操作时，我们的管理者无法区分谁是谁，一旦发生运维事故，很难快速地定位“责任人”。</li><li><strong>操作过程不透明：</strong> 顾名思义，就是指我们的运维人员做了什么管理者无从得知？尤其是在第三方运维场景，我们经常会听到数据窃取、违规操作导致服务器异常等此类的新闻，我们缺乏相应的手段进行规避。</li><li><strong>账号共享、权限泛滥：</strong> 我们知道人是最难管理的，一旦掌握了主机的账号密码，就不可避免地会造成账号的泄露，最终导致权限泛滥、难以管理。</li><li><strong>合规性要求：</strong> 无论是网络安全法、等级保护，还是行业的法律法规，都有要求我们建设安全、完善的审计系统，从而确保我们的审计信息是完整、安全、可靠。</li></ul><p>针对上述我们提到的运维安全风险，堡垒机是怎么解决的呢！简单来讲：</p><ul><li>堡垒机给每个运维人员分配了一个堡垒机账户，确保身份的唯一；其次，利用堡垒机的单点登录能力，使我们的运维人员无需知道主机的账号密码，从而可以有效防止账号泄漏和共享，并且运维人员需要访问什么主机，需要我们的管理者事先授权。</li><li>另外，我们通过实时监控、录像回放等方式，也有效地解决了操作过程不透明的问题。</li><li>总的来讲，堡垒机通过一定的技术手段实现了事前的授权、事中的监控、事后的审计，满足合规性的要求</li></ul><h2 id="_3、-ip白名单" tabindex="-1">3、 ip白名单 <a class="header-anchor" href="#_3、-ip白名单" aria-hidden="true">#</a></h2><p>只接受信任的 ip</p><h2 id="二、加密算法" tabindex="-1">二、加密算法 <a class="header-anchor" href="#二、加密算法" aria-hidden="true">#</a></h2><ul><li><p>对称加密：加解密用同一密钥，密钥维护复杂 <code>n（n-1）/2</code>，不适合互联网传输密钥，加解密效率高。应用于加密数据。</p></li><li><p>非对称加密：公钥推不出私钥，每个用户一个非对称密钥对就可以，适合于互联网传输公钥，但是加密效率低，应用于数字签名及加密。</p></li></ul><h2 id="_1、-以-rsa-为例" tabindex="-1">1、 以 RSA 为例 <a class="header-anchor" href="#_1、-以-rsa-为例" aria-hidden="true">#</a></h2><p>常用于对内容进行加密，有效预防抓包等。</p><p>RSA 的加密过程如下：</p><ol><li><p>A 生成一对密钥（公钥和私钥），私钥不公开，A 自己保留。公钥为公开的，任何人可以获取。</p></li><li><p>A 传递自己的公钥给 B，B 用 A 的公钥对消息进行加密。</p></li><li><p>A 接收到 B 加密的消息，利用 A 自己的私钥对消息进行解密。</p></li></ol><p>在这个过程中，只有2次传递过程，第一次是 A 传递公钥给 B，第二次是 B 传递加密消息给 A，即使都被敌方截获，也没有危险性，因为只有 A 的私钥才能对消息进行解密，防止了消息内容的泄露。</p><h2 id="_2、-以-sign-为例" tabindex="-1">2、 以 sign 为例 <a class="header-anchor" href="#_2、-以-sign-为例" aria-hidden="true">#</a></h2><p>常用于接口验签。</p><p>加一个访问签名 sign ：例如你的 api 地址是 <a href="http://www.example.com/api" target="_blank" rel="noreferrer">http://www.example.com/api</a> 需要接受的参数有 a,b,c 三个 那么可以加一个签名验证sign（通过约定的key加密生成）。</p><p>例如</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$a=1; $b=2; $c=3; $key=&#39;abcdef&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">sign=sha1($a.$b.$c.$key);</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后访问使用 <a href="http://www.example.com/api?a=1&amp;b=2&amp;c=3&amp;sign=xxxx" target="_blank" rel="noreferrer">http://www.example.com/api?a=1&amp;b=2&amp;c=3&amp;sign=xxxx</a> api.php接收到$a，$b，$c，$token参数后，根据 a,b,c 与约定好的 key，计算 sha1($a.$b.$c.$​​key) 是否等于接收到的 sign，如果相同则返回数据，否则返回没有权限</p><h2 id="三、安全网关" tabindex="-1">三、安全网关 <a class="header-anchor" href="#三、安全网关" aria-hidden="true">#</a></h2><p>在网关进行拦截和监控的方法，常见的有 nginx+lua+redis 网关监控</p><p>注册、登录、验签也可以做到网关，网关登录后，可以访问你们公司该网关下面的所有应用程序。</p><h2 id="四、sql注入" tabindex="-1">四、sql注入 <a class="header-anchor" href="#四、sql注入" aria-hidden="true">#</a></h2><p><code>sql</code>注入产生的原因其实还是没有对输入输出进行安全过滤的问题，后台的直接将用户的输入当做了sql语句的一部分，然后就直接执行了，导致用户对<code>sql</code>语句可控。</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$arg = $_POST[&#39;user_name&#39;];</span></span>
<span class="line"><span style="color:#A6ACCD;">//$arg = 1&#39; or user_name=&#39;无辜用户&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">//$arg = 1&#39;; &#39;drop databases</span></span>
<span class="line"><span style="color:#A6ACCD;">$sql = &quot; select * from user where user_name = &#39;$arg&#39; &quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">$sql = &quot; select * from user where user_name = &#39;1&#39; or user_name=&#39;无辜用户&#39; &quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">$sql = &quot; select * from user where user_name = &#39;1&#39;; &#39;drop databases&#39; &quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>预防思路：</strong></p><p>1、不要随意开启生产环境中Webserver的错误显示。</p><p>2、永远不要信任来自用户端的变量输入，有固定格式的变量一定要严格检查对应的格式，没有固定格式的变量需</p><p>要对引号等特殊字符进行必要的过滤转义。</p><p><strong>3、使用预编译绑定变量的 SQL 语句，如 php 的 PDO 预编译和 mysqli 预编译等。【最有效】</strong></p><p>4、做好数据库帐号权限管理。</p><p>5、严格加密处理用户的机密信息。</p><h2 id="五、xss（跨站脚本攻击）" tabindex="-1">五、XSS（跨站脚本攻击） <a class="header-anchor" href="#五、xss（跨站脚本攻击）" aria-hidden="true">#</a></h2><p>跨站脚本攻击，<code>xss</code> 其实也算是注入的一种，只不过属于<code>html/js</code>注入，注入类漏洞的都是没有对用户输入输出进行安全处理导致的。</p><p>而 <code>csrf</code> 的话更有一种隐藏在黑暗中的刺客的感觉，而且是借刀杀人的那种，这里借的刀就是用户的会话状态（或者说cookie），举一个例子，比如你请求了一个带有 <code>csrf </code> 漏洞的普通页面，可能这个页面中就有这么一段代码</p><div class="language-html line-numbers-mode"><button class="copy"></button><span class="lang">html</span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">img</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">http://www.xxx.com?action</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">del&amp;id</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这段代码就悄悄地去请求了<code>www.xxx.com</code>，并且删除了id为2的文章</p><p><strong>预防思路：</strong></p><p>web 页面中可由用户输入的地方，如果对输入的数据转义、过滤处理 后台输出页面的时候，也需要对输出内容进行转义、过滤处理（因为攻击者可能通过其他方式把恶意脚本写入数据库） 前端对 html 标签属性、css 属性赋值的地方进行校验</p><p>注意：各种语言都可以找到 escapeHTML() 方法可以转义 html 字符。转义后为<code>%3Cscript%3Ewindow.open%28%22xxx.aaa.xxx%3Fparam%3D%22+document.cookie%29%3C/script%3E</code></p><p><strong>上网搜索xss正则过滤方法</strong></p><h2 id="六、csrf（跨站请求伪造）" tabindex="-1">六、CSRF（跨站请求伪造） <a class="header-anchor" href="#六、csrf（跨站请求伪造）" aria-hidden="true">#</a></h2><p><code>CSRF（Cross-site request forgery）</code>也被称为 one-click attack或者 session riding，中文全称是叫跨站请求伪造。</p><p>一般来说，攻击者通过伪造用户的浏览器的请求，向访问一个用户自己曾经认证访问过的网站发送出去，使目标网站接收并误以为是用户的真实操作而去执行命令。常用于盗取账号、转账、发送虚假消息等。攻击者利用网站对请求的验证漏洞而实现这样的攻击行为，网站能够确认请求来源于用户的浏览器，却不能验证请求是否源于用户的真实意愿下的操作行为。</p><p><strong>验证请求的来源站点：</strong></p><p>在服务器端验证请求的来源站点。因为CSRF攻击大多数都是来自第三方站点。 通过 http 请求头中的 Referer 和 Origin 属性验证</p><p><strong>1、referer属性：</strong> 记录了该http请求的来源地址，但有些场景不适合将来源URL暴露给服务器，所以可以设置不用上传，并且referer 属性是可以修改的，所以在服务器端校验 referer 属性并没有那么可靠</p><p><strong>2、origin属性：</strong> 通过 XMLHttpRequest、Fetch 发起的跨站请求或者 Post 方法发送请求时，都会带上 origin，所以服务器可以优先判断 Origin 属性，再根据实际情况判断是否使用 referer 判断。</p><p><strong>CSRF Token：</strong></p><p>除了上面两个方法之外，还可以使用CSRF Token来验证。 1、在浏览器向服务器发起请求时，服务器生成一个 CSRF Token（字符串）发送给浏览器，然后将该字符串放入页面中</p><p>2、浏览器请求时（如表单提交）需要带上这个 CSRF Token。服务器收到请求后，验证 CSRF 是否合法，如果不合法拒绝即可。</p><p>3、相关接口网关只容许信任站点进来请求</p><p>要求用户输入验证码，比如手机短信验证码</p><h2 id="七、ddos（分布式拒绝服务）" tabindex="-1">七、DDOS（分布式拒绝服务） <a class="header-anchor" href="#七、ddos（分布式拒绝服务）" aria-hidden="true">#</a></h2><p><strong>ddos 是什么</strong></p><p>通俗的例子：</p><p>我开了一家餐厅，正常情况下，最多可以容纳100个人同时进餐。你直接走进餐厅，找一张桌子坐下点餐，马上就可以吃到东西。</p><p>很不幸，我得罪了一个流氓。他派出1000个人同时涌进餐厅。这些人看上去跟正常的顾客一样，每个都说”赶快上餐”。但是，餐厅的容量只有100个人，根本不可能同时满足这么多的点餐需求，加上他们把门口都堵死了，里三层外三层，正常用餐的客人根本进不来，实际上就把餐厅瘫痪了。</p><blockquote><p>这就是 DDoS 攻击，它在短时间内发起大量请求，耗尽服务器的资源，无法响应正常的访问，造成网站实质下线。</p></blockquote><p>DDoS 里面的 DoS 是 denial of service（停止服务）的缩写，表示这种攻击的目的，就是使得服务中断。最前面的那个 D 是 distributed (分布式)，表示攻击不是来自一个地方，而是来自四面八方，因此更难防。</p><p><strong>攻击如何工作？</strong></p><p>DDoS 攻击需要攻击者控制在线计算机网络才能进行攻击。计算机和其他计算机（如物联网设备）感染了恶意软件，将每个计算机转变为机器人（或僵尸）。然后，攻击者可以远程控制僵尸程序组，这称为僵尸网络。</p><p>一旦僵尸网络建立，<strong>攻击者就可以通过远程控制方法向每个机器人发送更新的指令来指导机器</strong>。当受害者的 IP 地址被僵尸网络作为目标时，每个僵尸程序将通过向目标发送请求来响应，可能导致目标服务器或网络溢出容量，从而导致对正常流量的拒绝服务。由于每个机器人都是合法的 Internet 设备，因此将攻击流量与正常流量分开可能很困难。</p><p>单个 HTTP 请求在客户端执行起来很便宜，并且目标服务器响应起来可能很昂贵，因为服务器通常必须加载多个文件并运行数据库查询才能创建网页。</p><p><strong>DDOS 攻击的特征</strong></p><p>1、攻击经常来源于一些相对固定的 IP 或 IP 段，每个 IP 都有远大于真实用户的连接数和请求数。</p><p>备注：这并不表明这种请求都是代表着 DDOS 攻击。在很多使用NAT的网络架构中，很多的客户端使用网关的 IP 地址访问公网资源。但是，即便如此，这样的请求数和连接数也会远少于 DDOS 攻击。</p><p>2、因为攻击是由木马发出且目的是使服务器超负荷，请求的频率会远远超过正常人的请求。</p><p>3、User-Agent 通常是一个非标准的值</p><p>伪造的 ip 是骗不过 tcp 的，能骗过 udp</p><p><strong>DDoS防御的方法</strong></p><p>硬件防火墙，充足的网络，升级主机服务器硬件，安装专业抗 DDOS 防火墙（安全狗，360卫士），备份网站，部署 CDN（一旦上了 CDN，千万不要泄露源服务器的 IP 地址，否则攻击者可以绕过 CDN 直接攻击源服务器），购买高防 IP（网站域名指向高防 IP，它提供一个缓冲层，清洗流量，并对源服务器的内容进行缓存），企业级 DDoS 清洗系统架构，启用基于 sysctl 的保护，分层解决方案。</p><p><strong>以上就是传说中的技术不够，用钱凑。</strong></p><p><strong>其它方法及注意事项：</strong></p><p>使用 CSF，iptables，UFW，APF 等软件防火墙</p><p>服务器上没用的端口一定要关掉，只对外网开放80等端口，有些重要端口，比如mysql的3306，只对指定ip白名单（公司内部服务器的ip地址）提供访问权限。</p><p>防止伪造 IP：伪造是修改数据包。使用 tcp 而不是 udp，TCP 无法伪造 IP，因为需要三次握手，比较安全；UDP 可以伪造。tcp 必须使用代理 ip，攻击者攻击成本高。</p><h2 id="八、nginx-防御-ddos" tabindex="-1"><strong>八、nginx 防御 DDOS</strong> <a class="header-anchor" href="#八、nginx-防御-ddos" aria-hidden="true">#</a></h2><p><strong>限制每个 IP 的请求速度</strong></p><p>设置 Nginx、Nginx Plus 的连接请求在一个真实用户请求的合理范围内。比如，如果你觉得一个正常用户每两秒可以请求一次登录页面，你就可以设置 Nginx 每两秒钟接收一个客户端 IP 的请求（大约等同于每分钟30个请求）。</p><div class="language-bash line-numbers-mode"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">limit_req_zone </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">binary_remote_addr zone=one:10m rate=60r/m</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    server </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /login.html </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        limit_req zone=one</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        ...</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>limit_req_zone 命令设置了一个叫 one 的共享内存区来存储请求状态的特定键值，在上面的例子中是客户IP($binary_remote_addr)。location 块中的 limit_req 通过引用one共享内存区来实现限制访问/login.html的目的。</p><p><strong>限制连接数量</strong></p><p>设置 Nginx、Nginx Plus 的连接数在一个真实用户请求的合理范围内。比如，你可以设置每个客户端 IP 连接/store 不 可以超过10个。</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">limit_conn_zone $binary_remote_addr zone=addr:10m;</span></span>
<span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /store/ {</span></span>
<span class="line"><span style="color:#A6ACCD;">        limit_conn addr 10;</span></span>
<span class="line"><span style="color:#A6ACCD;">        ...</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>limit_conn_zone 命令设置了一个叫 addr 的共享内存区来存储特定键值的状态，在上面的例子中是客户端 IP（$binary_remote_addr）。location块中limit_conn 通过引用addr共享内存区来限制到/store/的最大连接数为10。</p><p><strong>关闭慢连接</strong></p><p>有一些 DDOS 攻击，比如 Slowlris，是通过建立大量的连接并周期性的发送一些数据包保持会话来达到攻击目的，这种周期通常会低于正常的请求。这种情况我们可以通过关闭慢连接来抵御攻击。</p><p>client_body_timeout 命令用来定义读取客户端请求的超时时间， client_header_timeout 命令用来定于读取客户端请求头的超时时间。这两个参数的默认值都是 60s，我们可以通过下面的命令将他们设置为 5s：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    client_body_timeout 5s;</span></span>
<span class="line"><span style="color:#A6ACCD;">    client_header_timeout 5s;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>设置IP黑名单</strong></p><p>你确定攻击来源于 123.123.123.3、123.123.123.5、123.123.123.7 几个 IP，可以这样设置：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">    deny 123.123.123.3;</span></span>
<span class="line"><span style="color:#A6ACCD;">    deny 123.123.123.5;</span></span>
<span class="line"><span style="color:#A6ACCD;">    deny 123.123.123.7;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>设置 IP 白名单</strong></p><p>如果你的网站仅允许特定的 IP 或 IP 段访问，你可以结合使用 allow 和 deny 命令来限制仅允许你指定的 IP 地址访问你的网站。如下，你可以设置仅允许 192.168.1.0 段的内网用户访问：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">    allow 192.168.1.0/24;</span></span>
<span class="line"><span style="color:#A6ACCD;">    deny all;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>deny 命令会拒绝除了 allow 指定的 IP 段之外的所有其他 IP 的访问请求。</p><p><strong>使用缓存进行流量削峰</strong></p><p>通过打开 Nginx 的缓存功能并设置特定的缓存参数，可以削减来自攻击的流量，同时也可以减轻对后端服务器的请求压力。以下是一些有用的设置：</p><p>1、proxy_cache_use_stale 的 updating 参数告诉 Nginx什么时候该更新所缓存的对象。只需要到后端的一个更新请求，在缓存有效期间客户端对该对象的请求都无需访问后端服务器。当通过对一个文件的频繁请求来实施攻击时，缓存功能可极大的降低到后端服务器的请求。</p><p>2、proxy_cache_key 命令定义的键值通常包含一些内嵌的变量（默认的键值<code>$scheme</code>、<code>$proxy_host</code>、<code>$request_uri</code>包含了三个变量）。如果键值包含 <code>$query_string</code> 变量，当攻击的请求字符串是随机的时候就会给 Nginx 代理过重的缓存负担，因此我们建议一般情况下不要包含 $query_string 变量。</p><p><strong>屏蔽特定的请求</strong></p><p>可以设置 Nginx、Nginx Plus 屏蔽一些类型的请求：</p><ul><li>针对特定 URL 的请求</li><li>针对不是常见的 User-Agent 的请求</li><li>针对其他请求头中包含可以联想到攻击的值的请求</li></ul><p>比如，如果你判定攻击是针对一个特定的 URL：/foo.php，我们就可以屏蔽到这个页面的请求：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">location /foo.php {</span></span>
<span class="line"><span style="color:#A6ACCD;">	deny all;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>或者你判定攻击请求的 User-Agent 中包含 foo 或 bar，我们也可以屏蔽这些请求：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">    if ($http_user_agent ~* foo|bar) {</span></span>
<span class="line"><span style="color:#A6ACCD;">    	return 403;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>http_name 变量引用一个请求头，上述例子中是 User-Agent 头。可以针对其他的 http 头使用类似的方法来识别攻击。</p><p><strong>限制到后端服务器的连接数</strong></p><p>一个 Nginx、Nginx Plus 实例可以处理比后端服务器多的多的并发请求。在 Nginx Plus 中，你可以限制到每一个后端服务器的连接数，比如可以设置 Nginx Plus 与 website upstream 中的每个后端服务器建立的连接数不得超过200个：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">upstream website {</span></span>
<span class="line"><span style="color:#A6ACCD;">    server 192.168.100.1:80 max_conns=200;</span></span>
<span class="line"><span style="color:#A6ACCD;">    server 192.168.100.2:80 max_conns=200;</span></span>
<span class="line"><span style="color:#A6ACCD;">    queue 10 timeout=30s;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>max_conns 参数可以针对每一个后端服务器设置 Nginx Plus 可以与之建立的最大连接数。queue 命令设置了当每个 后端服务器都达到最大连接数后的队列大小， timeout 参数指定了请求在队列中的保留时间。</p><p><strong>用 nginx + lua 实现自动 ip 封禁和限流</strong></p><p>lua 将 ip 访问量存入 redis，结合 redis 进行 ip 访问频率等的追踪和自动封禁。</p><h2 id="九、syn攻击原理" tabindex="-1">九、SYN攻击原理 <a class="header-anchor" href="#九、syn攻击原理" aria-hidden="true">#</a></h2><p>SYN 攻击属于 DOS 攻击的一种，它利用 TCP 协议缺陷，<strong>通过发送大量的半连接请求，耗费 CPU 和内存资源。</strong></p><p>SYN 攻击除了能影响主机外，还可以危害路由器、防火墙等网络系统，事实上SYN攻击并不管目标是什么系统， 只要这些系统打开TCP服务就可以实施。</p><p>服务器接收到连接请求(syn=j)，将此信息加入未连接队列，并发送请求包给客户(syn=k,ack=j+1)，此时进入 SYN_RECV 状态。 当服务器未收到客户端的确认包时，重发请求包，一直到超时，才将此条目从未连接队列删除。 配合 IP 欺骗，SYN 攻击能达到很好的效果，通常，客户端在短时间内伪造大量不存在的 IP 地址， 向服务器不断地发送 syn 包，服务器回复确认包，并等待客户的确认，由于源地址是不存在的，服务器需要不断的重发直至超时，这些伪造的 SYN 包将长时间占用未连接队列，正常的SYN请求被丢弃， 目标系统运行缓慢，严重者引起网络堵塞甚至系统瘫痪。</p><p><strong>SYN 防御：</strong></p><p>其实最常用的一个手段就是优化主机系统设置。比如降低 SYN timeout 时间，使得主机尽快释放半连接的占用或者采用 SYN cookie设置，如果短时间内收到了某个 IP 的重复 SYN 请求，我们就认为受到了攻击。</p><h2 id="十、什么是同源策略？【概念】" tabindex="-1">十、什么是同源策略？【概念】 <a class="header-anchor" href="#十、什么是同源策略？【概念】" aria-hidden="true">#</a></h2><p>为了防止不同域在用户浏览器中彼此干扰，浏览器对从不同来源（域）收到的内容进行隔离。 浏览器不允许任何旧有脚本访问一站点的 cookie，否则，会话容易被劫持。</p><p>只有发布 cookie 的站点能够访问这些 cookie，只有通过该站点返回的页面所包含或加载的 JavaScript 才能访问 cookie。</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-37ebe389 data-v-a54a85bd><div class="edit-info" data-v-a54a85bd><!----><div class="last-updated" data-v-a54a85bd><p class="VPLastUpdated" data-v-a54a85bd data-v-f7d51a9c>Last updated: <time datatime="2023-03-31T09:47:16.000Z" data-v-f7d51a9c></time></p></div></div><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><!----></div><div class="pager" data-v-a54a85bd><a class="pager-link next" href="/guo-notes/classify/%E9%9D%A2%E8%AF%95%E5%B8%B8%E9%97%AE/%E4%B8%80%E6%AC%A1%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E5%AE%8C%E6%95%B4%E8%BF%87%E7%A8%8B.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>一次网络请求的完整过程</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"classify_docker_docker compose服务编排.md\":\"655facb6\",\"classify_docker_dockerhub和私人仓库.md\":\"a40ffe45\",\"classify_docker_dockerfile.md\":\"de65de7f\",\"classify_docker_docker介绍.md\":\"141385ff\",\"classify_docker_docker命令.md\":\"d3690ad7\",\"classify_docker_docker安装和启动.md\":\"f37e85e5\",\"classify_docker_docker架构.md\":\"924be479\",\"classify_elasticsearch_elasticsearch介绍.md\":\"fa72602b\",\"classify_elasticsearch_elasticsearch.md\":\"b8ab7aec\",\"classify_kafka_kafka-php整合.md\":\"259f332f\",\"classify_kafka_kafka-微服务整合.md\":\"d99cab23\",\"classify_kafka_kafka.md\":\"84007841\",\"classify_kafka_kafka介绍.md\":\"ab6f0753\",\"classify_kafka_kafka和rabbitmq对比.md\":\"0f3974d9\",\"classify_kafka_kafka集群.md\":\"22743ce8\",\"classify_kafka_kafka零拷贝技术.md\":\"05d1ecc3\",\"classify_kubernetes_dashboard.md\":\"21c0a6f4\",\"classify_kubernetes_kubernetes介绍.md\":\"4d21badc\",\"classify_kubernetes_kubernetes实战入门.md\":\"45403e0b\",\"classify_kubernetes_kubernetes资源管理.md\":\"07f42438\",\"classify_kubernetes_kubernetes集群环境搭建.md\":\"e76062bc\",\"classify_kubernetes_pod控制器详解.md\":\"0755e433\",\"classify_kubernetes_pod详解.md\":\"2102bed0\",\"classify_kubernetes_service详解.md\":\"b9ada473\",\"classify_kubernetes_安全认证.md\":\"4fea5a86\",\"classify_kubernetes_数据存储.md\":\"ab15e9bc\",\"classify_nginx_nginx.md\":\"19c5b7c1\",\"classify_rabbitmq_exchange核心概念.md\":\"1ab4b083\",\"classify_rabbitmq_mq的概念.md\":\"555dd70a\",\"classify_rabbitmq_mq的种类和对比.md\":\"41b780cd\",\"classify_rabbitmq_rabbitmq命令行.md\":\"2a2a2eab\",\"classify_rabbitmq_rabbitmq工作模式.md\":\"f4e7eb68\",\"classify_rabbitmq_rabbitmq应用方案.md\":\"613e9e69\",\"classify_rabbitmq_rabbitmq的安装和启动.md\":\"ce1e2443\",\"classify_rabbitmq_rabbitmq简介.md\":\"d1274610\",\"classify_rabbitmq_rabbitmq管控台介绍.md\":\"2c5d24be\",\"classify_rabbitmq_rabbitmq集群搭建.md\":\"def4a4eb\",\"classify_rabbitmq_rabbitmq高级特性.md\":\"79e96997\",\"classify_rabbitmq_rabbitmq高级特性1.md\":\"61e0d502\",\"classify_redis_redis主从.md\":\"8418e1a5\",\"classify_redis_redis事务.md\":\"252b4505\",\"classify_redis_redis五大数据类型实现原理.md\":\"7a58f464\",\"classify_redis_redis介绍.md\":\"9a026f6c\",\"classify_redis_redis内存回收.md\":\"aad262c9\",\"classify_redis_redis内存淘汰策略.md\":\"0b1c3670\",\"classify_redis_redis内存碎片率.md\":\"be48d293\",\"classify_redis_redis分布式锁.md\":\"b9931f89\",\"classify_redis_redis哨兵.md\":\"607d9de5\",\"classify_redis_redis底层数据结构.md\":\"68b4c269\",\"classify_redis_redis慢查询和管道.md\":\"b1727e90\",\"classify_redis_redis持久化.md\":\"9c60aa93\",\"classify_redis_redis数据类型简介.md\":\"5f40496b\",\"classify_redis_redis缓存击穿、穿透、雪崩.md\":\"29bad1f6\",\"classify_redis_redis配置文件解析.md\":\"e1343fb2\",\"classify_redis_redis集群.md\":\"65743d8e\",\"classify_algorithm_concept_复杂度-时间复杂度和空间复杂度.md\":\"4231ba14\",\"classify_algorithm_concept_数据结构-堆.md\":\"75f9fe15\",\"classify_algorithm_concept_数据结构-栈与队列.md\":\"90975225\",\"classify_algorithm_concept_数据结构-树.md\":\"994db728\",\"classify_algorithm_concept_算法-排序算法.md\":\"ad63de45\",\"classify_algorithm_concept_算法-查找算法.md\":\"2697c31f\",\"classify_algorithm_concept_算法-深度优先搜索和广度优先搜索.md\":\"0c1c9409\",\"classify_algorithm_index.md\":\"de774b09\",\"classify_algorithm_title_leetcode-1.md\":\"7c5fc3fc\",\"classify_algorithm_title_leetcode-101.md\":\"967df4e5\",\"classify_algorithm_title_leetcode-104.md\":\"8a2faa09\",\"classify_algorithm_title_leetcode-110.md\":\"29403a59\",\"classify_algorithm_title_leetcode-141.md\":\"72ddd440\",\"classify_algorithm_title_leetcode-142.md\":\"09248920\",\"classify_algorithm_title_leetcode-144.md\":\"45427b40\",\"classify_algorithm_title_leetcode-145.md\":\"17e92f2d\",\"classify_algorithm_title_leetcode-160.md\":\"60cbe702\",\"classify_algorithm_title_leetcode-206.md\":\"7912b842\",\"classify_algorithm_title_leetcode-21.md\":\"6b3b78ac\",\"classify_algorithm_title_leetcode-226.md\":\"5f59d059\",\"classify_algorithm_title_leetcode-232.md\":\"5179497a\",\"classify_algorithm_title_leetcode-234.md\":\"dd7acdc7\",\"classify_algorithm_title_leetcode-283.md\":\"84352214\",\"classify_algorithm_title_leetcode-394.md\":\"0e163add\",\"classify_algorithm_title_leetcode-448.md\":\"6603b838\",\"classify_algorithm_title_leetcode-70.md\":\"ab7cbcf3\",\"classify_algorithm_title_leetcode-83.md\":\"b598c1f0\",\"classify_algorithm_title_leetcode-876.md\":\"d4127d2d\",\"classify_algorithm_title_leetcode-88.md\":\"190904c6\",\"classify_algorithm_title_leetcode-912.md\":\"4e55969c\",\"classify_algorithm_title_leetcode-94.md\":\"b66212d9\",\"classify_algorithm_title_leetcode-模板.md\":\"dd7abcd1\",\"classify_algorithm_title_剑指offer-22.md\":\"071899f2\",\"classify_algorithm_其他-设计.md\":\"1b7a410b\",\"classify_algorithm_基础-排序.md\":\"a8fd5bca\",\"classify_algorithm_基础数据结构-哈希表.md\":\"55c2efe9\",\"classify_algorithm_基础数据结构-字符串.md\":\"b4c57240\",\"classify_algorithm_基础数据结构-数组.md\":\"74014a9b\",\"classify_algorithm_基础数据结构-栈.md\":\"792f534a\",\"classify_algorithm_基础数据结构-树.md\":\"6194934f\",\"classify_algorithm_基础数据结构-链表.md\":\"6d312aa4\",\"classify_algorithm_基础数据结构-队列.md\":\"ca716a8f\",\"classify_algorithm_技巧-双指针.md\":\"ae6d45a7\",\"classify_algorithm_数学-斐波那契数列.md\":\"e8a9d2a3\",\"classify_algorithm_数学-相遇问题.md\":\"faf92821\",\"classify_algorithm_算法-动态规划.md\":\"551a4557\",\"classify_algorithm_算法-广度优先搜索.md\":\"2ca4c1a1\",\"classify_algorithm_算法-排序.md\":\"221cef6f\",\"classify_algorithm_算法-深度优先搜索.md\":\"5a6a1283\",\"classify_algorithm_算法-迭代.md\":\"78c0def3\",\"classify_algorithm_算法-递归.md\":\"d796f79a\",\"classify_mysql_mvcc多版本并发控制.md\":\"a3215a75\",\"classify_mysql_mysql三大日志.md\":\"0e324ea0\",\"classify_mysql_mysql主从复制.md\":\"d80c3229\",\"classify_mysql_mysql事务.md\":\"892bab2f\",\"classify_mysql_mysql介绍.md\":\"aa74d972\",\"classify_mysql_mysql分区.md\":\"9f990b35\",\"classify_mysql_mysql分库分表.md\":\"ea70aaa9\",\"classify_mysql_mysql索引.md\":\"19e60ba6\",\"classify_mysql_mysql语法.md\":\"2166e60e\",\"classify_mysql_mysql读写分离.md\":\"1cd5af3f\",\"classify_mysql_mysql负载均衡和高可用.md\":\"ba820133\",\"classify_mysql_mysql锁.md\":\"e9dcca56\",\"classify_mysql_sql语句优化.md\":\"7e4218cb\",\"classify_mysql_sql语句执行流程.md\":\"a48bacf6\",\"classify_mysql_存储引擎.md\":\"54fabccf\",\"classify_mysql_性能分析.md\":\"2aa5ada9\",\"classify_mysql_物理文件.md\":\"43e326f2\",\"classify_mysql_管理常用工具.md\":\"e3c067f2\",\"classify_sundry_concept_存储单位与速率单位.md\":\"d9168b29\",\"classify_sundry_concept_性能指标.md\":\"c0b289bb\",\"classify_sundry_tools_git_github 连接失败.md\":\"657f2cb0\",\"classify_sundry_tools_vscode_vscode 启动 debug.md\":\"ee0e5ba9\",\"classify_框架学习_laravel_artisan控制台命令.md\":\"b6ba645b\",\"classify_框架学习_laravel_生命周期相关核心概念.md\":\"8cba0160\",\"classify_解决方案_redis主从存在的问题和解决方案.md\":\"56b656f7\",\"classify_解决方案_数据库与缓存一致性解决方案.md\":\"cb8257fa\",\"classify_计算机基础_计算机网络_io模型.md\":\"8759accd\",\"classify_计算机基础_计算机网络_index.md\":\"098ea9ee\",\"classify_设计模式.md\":\"4f9a1cf6\",\"classify_面试常问_web安全.md\":\"068eca72\",\"classify_面试常问_一次网络请求的完整过程.md\":\"aff879ca\",\"index.md\":\"f2652fb8\",\"preface_install.md\":\"4a199460\",\"preface_preface.md\":\"4282cc4a\"}")</script>
    <script type="module" async src="/guo-notes/assets/app.a231f820.js"></script>
    
  </body>
</html>