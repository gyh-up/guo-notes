import{_ as s,c as n,o as a,a as p}from"./app.a231f820.js";const l="/guo-notes/kubenetes/image-20200612005334159.png",e="/guo-notes/kubenetes/image-20200612005524778.png",o="/guo-notes/kubenetes/image-20200416140251491.png",c="/guo-notes/kubenetes/image-20200608155858271.png",r="/guo-notes/kubenetes/image-20200608163326496.png",t="/guo-notes/kubenetes/image-20200612010223537.png",i="/guo-notes/kubenetes/image-20200618213054113.png",y="/guo-notes/kubenetes/image-20200618213149531.png",R=JSON.parse('{"title":"Pod\u63A7\u5236\u5668\u8BE6\u89E3","description":"","frontmatter":{"typora-root-url":"..\\\\..\\\\public","typora-copy-images-to":"..\\\\..\\\\public\\\\kubenetes"},"headers":[{"level":2,"title":"\u4E00\u3001Pod\u63A7\u5236\u5668\u4ECB\u7ECD","slug":"\u4E00\u3001pod\u63A7\u5236\u5668\u4ECB\u7ECD","link":"#\u4E00\u3001pod\u63A7\u5236\u5668\u4ECB\u7ECD","children":[]},{"level":2,"title":"\u4E8C\u3001ReplicaSet(RS)","slug":"\u4E8C\u3001replicaset-rs","link":"#\u4E8C\u3001replicaset-rs","children":[]},{"level":2,"title":"\u4E09\u3001Deployment(Deploy)","slug":"\u4E09\u3001deployment-deploy","link":"#\u4E09\u3001deployment-deploy","children":[]},{"level":2,"title":"\u56DB\u3001Horizontal Pod Autoscaler(HPA)","slug":"\u56DB\u3001horizontal-pod-autoscaler-hpa","link":"#\u56DB\u3001horizontal-pod-autoscaler-hpa","children":[]},{"level":2,"title":"\u4E94\u3001DaemonSet(DS)","slug":"\u4E94\u3001daemonset-ds","link":"#\u4E94\u3001daemonset-ds","children":[]},{"level":2,"title":"\u516D\u3001Job","slug":"\u516D\u3001job","link":"#\u516D\u3001job","children":[]},{"level":2,"title":"\u4E03\u3001CronJob(CJ)","slug":"\u4E03\u3001cronjob-cj","link":"#\u4E03\u3001cronjob-cj","children":[]}],"relativePath":"classify/Kubernetes/Pod\u63A7\u5236\u5668\u8BE6\u89E3.md","lastUpdated":1680256036000}'),D={name:"classify/Kubernetes/Pod\u63A7\u5236\u5668\u8BE6\u89E3.md"},C=p('<h1 id="pod\u63A7\u5236\u5668\u8BE6\u89E3" tabindex="-1">Pod\u63A7\u5236\u5668\u8BE6\u89E3 <a class="header-anchor" href="#pod\u63A7\u5236\u5668\u8BE6\u89E3" aria-hidden="true">#</a></h1><h2 id="\u4E00\u3001pod\u63A7\u5236\u5668\u4ECB\u7ECD" tabindex="-1">\u4E00\u3001Pod\u63A7\u5236\u5668\u4ECB\u7ECD <a class="header-anchor" href="#\u4E00\u3001pod\u63A7\u5236\u5668\u4ECB\u7ECD" aria-hidden="true">#</a></h2><p>Pod\u662Fkubernetes\u7684\u6700\u5C0F\u7BA1\u7406\u5355\u5143\uFF0C\u5728kubernetes\u4E2D\uFF0C\u6309\u7167pod\u7684\u521B\u5EFA\u65B9\u5F0F\u53EF\u4EE5\u5C06\u5176\u5206\u4E3A\u4E24\u7C7B\uFF1A</p><ul><li>\u81EA\u4E3B\u5F0Fpod\uFF1Akubernetes\u76F4\u63A5\u521B\u5EFA\u51FA\u6765\u7684Pod\uFF0C\u8FD9\u79CDpod\u5220\u9664\u540E\u5C31\u6CA1\u6709\u4E86\uFF0C\u4E5F\u4E0D\u4F1A\u91CD\u5EFA</li><li>\u63A7\u5236\u5668\u521B\u5EFA\u7684pod\uFF1Akubernetes\u901A\u8FC7\u63A7\u5236\u5668\u521B\u5EFA\u7684pod\uFF0C\u8FD9\u79CDpod\u5220\u9664\u4E86\u4E4B\u540E\u8FD8\u4F1A\u81EA\u52A8\u91CD\u5EFA</li></ul><blockquote><p><strong><code>\u4EC0\u4E48\u662FPod\u63A7\u5236\u5668</code></strong></p><p>Pod\u63A7\u5236\u5668\u662F\u7BA1\u7406pod\u7684\u4E2D\u95F4\u5C42\uFF0C\u4F7F\u7528Pod\u63A7\u5236\u5668\u4E4B\u540E\uFF0C\u53EA\u9700\u8981\u544A\u8BC9Pod\u63A7\u5236\u5668\uFF0C\u60F3\u8981\u591A\u5C11\u4E2A\u4EC0\u4E48\u6837\u7684Pod\u5C31\u53EF\u4EE5\u4E86\uFF0C\u5B83\u4F1A\u521B\u5EFA\u51FA\u6EE1\u8DB3\u6761\u4EF6\u7684Pod\u5E76\u786E\u4FDD\u6BCF\u4E00\u4E2APod\u8D44\u6E90\u5904\u4E8E\u7528\u6237\u671F\u671B\u7684\u76EE\u6807\u72B6\u6001\u3002\u5982\u679CPod\u8D44\u6E90\u5728\u8FD0\u884C\u4E2D\u51FA\u73B0\u6545\u969C\uFF0C\u5B83\u4F1A\u57FA\u4E8E\u6307\u5B9A\u7B56\u7565\u91CD\u65B0\u7F16\u6392Pod\u3002</p></blockquote><p>\u5728kubernetes\u4E2D\uFF0C\u6709\u5F88\u591A\u7C7B\u578B\u7684pod\u63A7\u5236\u5668\uFF0C\u6BCF\u79CD\u90FD\u6709\u81EA\u5DF1\u7684\u9002\u5408\u7684\u573A\u666F\uFF0C\u5E38\u89C1\u7684\u6709\u4E0B\u9762\u8FD9\u4E9B\uFF1A</p><ul><li>ReplicationController\uFF1A\u6BD4\u8F83\u539F\u59CB\u7684pod\u63A7\u5236\u5668\uFF0C\u5DF2\u7ECF\u88AB\u5E9F\u5F03\uFF0C\u7531ReplicaSet\u66FF\u4EE3</li><li>ReplicaSet\uFF1A\u4FDD\u8BC1\u526F\u672C\u6570\u91CF\u4E00\u76F4\u7EF4\u6301\u5728\u671F\u671B\u503C\uFF0C\u5E76\u652F\u6301pod\u6570\u91CF\u6269\u7F29\u5BB9\uFF0C\u955C\u50CF\u7248\u672C\u5347\u7EA7</li><li>Deployment\uFF1A\u901A\u8FC7\u63A7\u5236ReplicaSet\u6765\u63A7\u5236Pod\uFF0C\u5E76\u652F\u6301\u6EDA\u52A8\u5347\u7EA7\u3001\u56DE\u9000\u7248\u672C</li><li>Horizontal Pod Autoscaler\uFF1A\u53EF\u4EE5\u6839\u636E\u96C6\u7FA4\u8D1F\u8F7D\u81EA\u52A8\u6C34\u5E73\u8C03\u6574Pod\u7684\u6570\u91CF\uFF0C\u5B9E\u73B0\u524A\u5CF0\u586B\u8C37</li><li>DaemonSet\uFF1A\u5728\u96C6\u7FA4\u4E2D\u7684\u6307\u5B9ANode\u4E0A\u8FD0\u884C\u4E14\u4EC5\u8FD0\u884C\u4E00\u4E2A\u526F\u672C\uFF0C\u4E00\u822C\u7528\u4E8E\u5B88\u62A4\u8FDB\u7A0B\u7C7B\u7684\u4EFB\u52A1</li><li>Job\uFF1A\u5B83\u521B\u5EFA\u51FA\u6765\u7684pod\u53EA\u8981\u5B8C\u6210\u4EFB\u52A1\u5C31\u7ACB\u5373\u9000\u51FA\uFF0C\u4E0D\u9700\u8981\u91CD\u542F\u6216\u91CD\u5EFA\uFF0C\u7528\u4E8E\u6267\u884C\u4E00\u6B21\u6027\u4EFB\u52A1</li><li>Cronjob\uFF1A\u5B83\u521B\u5EFA\u7684Pod\u8D1F\u8D23\u5468\u671F\u6027\u4EFB\u52A1\u63A7\u5236\uFF0C\u4E0D\u9700\u8981\u6301\u7EED\u540E\u53F0\u8FD0\u884C</li><li>StatefulSet\uFF1A\u7BA1\u7406\u6709\u72B6\u6001\u5E94\u7528</li></ul><h2 id="\u4E8C\u3001replicaset-rs" tabindex="-1">\u4E8C\u3001ReplicaSet(RS) <a class="header-anchor" href="#\u4E8C\u3001replicaset-rs" aria-hidden="true">#</a></h2><p>ReplicaSet\u7684\u4E3B\u8981\u4F5C\u7528\u662F<strong>\u4FDD\u8BC1\u4E00\u5B9A\u6570\u91CF\u7684pod\u6B63\u5E38\u8FD0\u884C</strong>\uFF0C\u5B83\u4F1A\u6301\u7EED\u76D1\u542C\u8FD9\u4E9BPod\u7684\u8FD0\u884C\u72B6\u6001\uFF0C\u4E00\u65E6Pod\u53D1\u751F\u6545\u969C\uFF0C\u5C31\u4F1A\u91CD\u542F\u6216\u91CD\u5EFA\u3002\u540C\u65F6\u5B83\u8FD8\u652F\u6301\u5BF9pod\u6570\u91CF\u7684\u6269\u7F29\u5BB9\u548C\u955C\u50CF\u7248\u672C\u7684\u5347\u964D\u7EA7\u3002</p><p><img src="'+l+`" alt="img"></p><p>ReplicaSet\u7684\u8D44\u6E90\u6E05\u5355\u6587\u4EF6\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7248\u672C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ReplicaSet</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7C7B\u578B       </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5143\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># rs\u540D\u79F0 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6240\u5C5E\u547D\u540D\u7A7A\u95F4 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6807\u7B7E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rs</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BE6\u60C5\u63CF\u8FF0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u526F\u672C\u6570\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u9009\u62E9\u5668\uFF0C\u901A\u8FC7\u5B83\u6307\u5B9A\u8BE5\u63A7\u5236\u5668\u7BA1\u7406\u54EA\u4E9Bpod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">      </span><span style="color:#676E95;"># Labels\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchExpressions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># Expressions\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">operator</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">In</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">nginx-pod</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6A21\u677F\uFF0C\u5F53\u526F\u672C\u6570\u91CF\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u6839\u636E\u4E0B\u9762\u7684\u6A21\u677F\u521B\u5EFApod\u526F\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">containerPort</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>\u5728\u8FD9\u91CC\u9762\uFF0C\u9700\u8981\u65B0\u4E86\u89E3\u7684\u914D\u7F6E\u9879\u5C31\u662F<code>spec</code>\u4E0B\u9762\u51E0\u4E2A\u9009\u9879\uFF1A</p><ul><li><p>replicas\uFF1A\u6307\u5B9A\u526F\u672C\u6570\u91CF\uFF0C\u5176\u5B9E\u5C31\u662F\u5F53\u524Drs\u521B\u5EFA\u51FA\u6765\u7684pod\u7684\u6570\u91CF\uFF0C\u9ED8\u8BA4\u4E3A1</p></li><li><p>selector\uFF1A\u9009\u62E9\u5668\uFF0C\u5B83\u7684\u4F5C\u7528\u662F\u5EFA\u7ACBpod\u63A7\u5236\u5668\u548Cpod\u4E4B\u95F4\u7684\u5173\u8054\u5173\u7CFB\uFF0C\u91C7\u7528\u7684Label Selector\u673A\u5236</p><p>\u5728pod\u6A21\u677F\u4E0A\u5B9A\u4E49label\uFF0C\u5728\u63A7\u5236\u5668\u4E0A\u5B9A\u4E49\u9009\u62E9\u5668\uFF0C\u5C31\u53EF\u4EE5\u8868\u660E\u5F53\u524D\u63A7\u5236\u5668\u80FD\u7BA1\u7406\u54EA\u4E9Bpod\u4E86</p></li><li><p>template\uFF1A\u6A21\u677F\uFF0C\u5C31\u662F\u5F53\u524D\u63A7\u5236\u5668\u521B\u5EFApod\u6240\u4F7F\u7528\u7684\u6A21\u677F\u677F\uFF0C\u91CC\u9762\u5176\u5B9E\u5C31\u662F\u524D\u4E00\u7AE0\u5B66\u8FC7\u7684pod\u7684\u5B9A\u4E49</p></li></ul><p><strong>\u521B\u5EFAReplicaSet</strong></p><p>\u521B\u5EFApc-replicaset.yaml\u6587\u4EF6\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ReplicaSet</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-replicaset</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFArs</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl create -f pc-replicaset.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps/pc-replicaset created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Brs</span></span>
<span class="line"><span style="color:#676E95;"># DESIRED:\u671F\u671B\u526F\u672C\u6570\u91CF  </span></span>
<span class="line"><span style="color:#676E95;"># CURRENT:\u5F53\u524D\u526F\u672C\u6570\u91CF  </span></span>
<span class="line"><span style="color:#676E95;"># READY:\u5DF2\u7ECF\u51C6\u5907\u597D\u63D0\u4F9B\u670D\u52A1\u7684\u526F\u672C\u6570\u91CF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs pc-replicaset -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME          DESIRED   CURRENT READY AGE   CONTAINERS   IMAGES             SELECTOR</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset 3         3       3     22s   nginx        nginx:1.17.1       app=nginx-pod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770B\u5F53\u524D\u63A7\u5236\u5668\u521B\u5EFA\u51FA\u6765\u7684pod</span></span>
<span class="line"><span style="color:#676E95;"># \u8FD9\u91CC\u53D1\u73B0\u63A7\u5236\u5668\u521B\u5EFA\u51FA\u6765\u7684pod\u7684\u540D\u79F0\u662F\u5728\u63A7\u5236\u5668\u540D\u79F0\u540E\u9762\u62FC\u63A5\u4E86-xxxxx\u968F\u673A\u7801</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pod -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                          READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-6vmvt   1/1     Running   0          54s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fmb8f   1/1     Running   0          54s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-snrk2   1/1     Running   0          54s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>\u6269\u7F29\u5BB9</strong></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u7F16\u8F91rs\u7684\u526F\u672C\u6570\u91CF\uFF0C\u4FEE\u6539spec:replicas: 6\u5373\u53EF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl edit rs pc-replicaset -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps/pc-replicaset edited</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                          READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-6vmvt   1/1     Running   0          114m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-cftnp   1/1     Running   0          10s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fjlm6   1/1     Running   0          10s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fmb8f   1/1     Running   0          114m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-s2whj   1/1     Running   0          10s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-snrk2   1/1     Running   0          114m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5F53\u7136\u4E5F\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u547D\u4EE4\u5B9E\u73B0</span></span>
<span class="line"><span style="color:#676E95;"># \u4F7F\u7528scale\u547D\u4EE4\u5B9E\u73B0\u6269\u7F29\u5BB9\uFF0C \u540E\u9762--replicas=n\u76F4\u63A5\u6307\u5B9A\u76EE\u6807\u6570\u91CF\u5373\u53EF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl scale rs pc-replicaset --replicas=2 -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps/pc-replicaset scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u547D\u4EE4\u8FD0\u884C\u5B8C\u6BD5\uFF0C\u7ACB\u5373\u67E5\u770B\uFF0C\u53D1\u73B0\u5DF2\u7ECF\u67094\u4E2A\u5F00\u59CB\u51C6\u5907\u9000\u51FA\u4E86</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       READY   STATUS        RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-6vmvt   0/1     Terminating   0          118m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-cftnp   0/1     Terminating   0          4m17s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fjlm6   0/1     Terminating   0          4m17s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fmb8f   1/1     Running       0          118m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-s2whj   0/1     Terminating   0          4m17s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-snrk2   1/1     Running       0          118m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">#\u7A0D\u7B49\u7247\u523B\uFF0C\u5C31\u53EA\u5269\u4E0B2\u4E2A\u4E86</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-fmb8f   1/1     Running   0          119m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-snrk2   1/1     Running   0          119m</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>\u955C\u50CF\u5347\u7EA7</strong></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u7F16\u8F91rs\u7684\u5BB9\u5668\u955C\u50CF - image: nginx:1.17.2</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl edit rs pc-replicaset -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps/pc-replicaset edited</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u518D\u6B21\u67E5\u770B\uFF0C\u53D1\u73B0\u955C\u50CF\u7248\u672C\u5DF2\u7ECF\u53D8\u66F4\u4E86</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                DESIRED  CURRENT   READY   AGE    CONTAINERS   IMAGES        ...</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset       2        2         2       140m   nginx         nginx:1.17.2  ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u540C\u6837\u7684\u9053\u7406\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528\u547D\u4EE4\u5B8C\u6210\u8FD9\u4E2A\u5DE5\u4F5C</span></span>
<span class="line"><span style="color:#676E95;"># kubectl set image rs rs\u540D\u79F0 \u5BB9\u5668=\u955C\u50CF\u7248\u672C -n namespace</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl set image rs pc-replicaset nginx=nginx:1.17.1  -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps/pc-replicaset image updated</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u518D\u6B21\u67E5\u770B\uFF0C\u53D1\u73B0\u955C\u50CF\u7248\u672C\u5DF2\u7ECF\u53D8\u66F4\u4E86</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                 DESIRED  CURRENT   READY   AGE    CONTAINERS   IMAGES            ...</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset        2        2         2       145m   nginx        nginx:1.17.1 ... </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>\u5220\u9664ReplicaSet</strong></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u4F7F\u7528kubectl delete\u547D\u4EE4\u4F1A\u5220\u9664\u6B64RS\u4EE5\u53CA\u5B83\u7BA1\u7406\u7684Pod</span></span>
<span class="line"><span style="color:#676E95;"># \u5728kubernetes\u5220\u9664RS\u524D\uFF0C\u4F1A\u5C06RS\u7684replicasclear\u8C03\u6574\u4E3A0\uFF0C\u7B49\u5F85\u6240\u6709\u7684Pod\u88AB\u5220\u9664\u540E\uFF0C\u5728\u6267\u884CRS\u5BF9\u8C61\u7684\u5220\u9664</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete rs pc-replicaset -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-replicaset</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pod -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">No resources found </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> dev namespace.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5982\u679C\u5E0C\u671B\u4EC5\u4EC5\u5220\u9664RS\u5BF9\u8C61\uFF08\u4FDD\u7559Pod\uFF09\uFF0C\u53EF\u4EE5\u4F7F\u7528kubectl delete\u547D\u4EE4\u65F6\u6DFB\u52A0--cascade=false\u9009\u9879\uFF08\u4E0D\u63A8\u8350\uFF09\u3002</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete rs pc-replicaset -n dev --cascade=false</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-replicaset</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                  READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-cl82j   1/1     Running   0          75s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-replicaset-dslhb   1/1     Running   0          75s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u4E5F\u53EF\u4EE5\u4F7F\u7528yaml\u76F4\u63A5\u5220\u9664(\u63A8\u8350)</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete -f pc-replicaset.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">replicaset.apps </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-replicaset</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="\u4E09\u3001deployment-deploy" tabindex="-1">\u4E09\u3001Deployment(Deploy) <a class="header-anchor" href="#\u4E09\u3001deployment-deploy" aria-hidden="true">#</a></h2><p>\u4E3A\u4E86\u66F4\u597D\u7684\u89E3\u51B3\u670D\u52A1\u7F16\u6392\u7684\u95EE\u9898\uFF0Ckubernetes\u5728V1.2\u7248\u672C\u5F00\u59CB\uFF0C\u5F15\u5165\u4E86Deployment\u63A7\u5236\u5668\u3002\u503C\u5F97\u4E00\u63D0\u7684\u662F\uFF0C\u8FD9\u79CD\u63A7\u5236\u5668\u5E76\u4E0D\u76F4\u63A5\u7BA1\u7406pod\uFF0C\u800C\u662F\u901A\u8FC7\u7BA1\u7406ReplicaSet\u6765\u7B80\u4ECB\u7BA1\u7406Pod\uFF0C\u5373\uFF1ADeployment\u7BA1\u7406ReplicaSet\uFF0CReplicaSet\u7BA1\u7406Pod\u3002\u6240\u4EE5Deployment\u6BD4ReplicaSet\u529F\u80FD\u66F4\u52A0\u5F3A\u5927\u3002</p><p><img src="`+e+`" alt="img"></p><p>Deployment\u4E3B\u8981\u529F\u80FD\u6709\u4E0B\u9762\u51E0\u4E2A\uFF1A</p><ul><li>\u652F\u6301ReplicaSet\u7684\u6240\u6709\u529F\u80FD</li><li>\u652F\u6301\u53D1\u5E03\u7684\u505C\u6B62\u3001\u7EE7\u7EED</li><li>\u652F\u6301\u6EDA\u52A8\u5347\u7EA7\u548C\u56DE\u6EDA\u7248\u672C</li></ul><p>Deployment\u7684\u8D44\u6E90\u6E05\u5355\u6587\u4EF6\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7248\u672C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deployment</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7C7B\u578B       </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5143\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># rs\u540D\u79F0 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6240\u5C5E\u547D\u540D\u7A7A\u95F4 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6807\u7B7E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">deploy</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BE6\u60C5\u63CF\u8FF0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u526F\u672C\u6570\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">revisionHistoryLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u4FDD\u7559\u5386\u53F2\u7248\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">paused</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6682\u505C\u90E8\u7F72\uFF0C\u9ED8\u8BA4\u662Ffalse</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">progressDeadlineSeconds</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u90E8\u7F72\u8D85\u65F6\u65F6\u95F4\uFF08s\uFF09\uFF0C\u9ED8\u8BA4\u662F600</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">strategy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">RollingUpdate</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rollingUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">maxSurge</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">30%</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6700\u5927\u989D\u5916\u53EF\u4EE5\u5B58\u5728\u7684\u526F\u672C\u6570\uFF0C\u53EF\u4EE5\u4E3A\u767E\u5206\u6BD4\uFF0C\u4E5F\u53EF\u4EE5\u4E3A\u6574\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">maxUnavailable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">30%</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6700\u5927\u4E0D\u53EF\u7528\u72B6\u6001\u7684 Pod \u7684\u6700\u5927\u503C\uFF0C\u53EF\u4EE5\u4E3A\u767E\u5206\u6BD4\uFF0C\u4E5F\u53EF\u4EE5\u4E3A\u6574\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u9009\u62E9\u5668\uFF0C\u901A\u8FC7\u5B83\u6307\u5B9A\u8BE5\u63A7\u5236\u5668\u7BA1\u7406\u54EA\u4E9Bpod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">      </span><span style="color:#676E95;"># Labels\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchExpressions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># Expressions\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">operator</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">In</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">nginx-pod</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6A21\u677F\uFF0C\u5F53\u526F\u672C\u6570\u91CF\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u6839\u636E\u4E0B\u9762\u7684\u6A21\u677F\u521B\u5EFApod\u526F\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">containerPort</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>\u521B\u5EFAdeployment</strong></p><p>\u521B\u5EFApc-deployment.yaml\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deployment</span><span style="color:#A6ACCD;">      </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-deployment</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAdeployment</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl create -f pc-deployment.yaml --record=true</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bdeployment</span></span>
<span class="line"><span style="color:#676E95;"># UP-TO-DATE \u6700\u65B0\u7248\u672C\u7684pod\u7684\u6570\u91CF</span></span>
<span class="line"><span style="color:#676E95;"># AVAILABLE  \u5F53\u524D\u53EF\u7528\u7684pod\u7684\u6570\u91CF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME            READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment   3/3     3            3           15s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Brs</span></span>
<span class="line"><span style="color:#676E95;"># \u53D1\u73B0rs\u7684\u540D\u79F0\u662F\u5728\u539F\u6765deployment\u7684\u540D\u5B57\u540E\u9762\u6DFB\u52A0\u4E86\u4E00\u4E2A10\u4F4D\u6570\u7684\u968F\u673A\u4E32</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78   3         3         3       23s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-d2c8n   1/1     Running   0          107s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-smpvp   1/1     Running   0          107s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-wvjd8   1/1     Running   0          107s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>\u6269\u7F29\u5BB9</strong></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u53D8\u66F4\u526F\u672C\u6570\u91CF\u4E3A5\u4E2A</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl scale deploy pc-deployment --replicas=5  -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bdeployment</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME            READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment   5/5     5            5           2m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;">#  kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-d2c8n   1/1     Running   0          4m19s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-jxmdq   1/1     Running   0          94s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-mktqv   1/1     Running   0          93s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-smpvp   1/1     Running   0          4m19s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-wvjd8   1/1     Running   0          4m19s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u7F16\u8F91deployment\u7684\u526F\u672C\u6570\u91CF\uFF0C\u4FEE\u6539spec:replicas: 4\u5373\u53EF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl edit deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment edited</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-d2c8n   1/1     Running   0          5m23s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-jxmdq   1/1     Running   0          2m38s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-smpvp   1/1     Running   0          5m23s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78-wvjd8   1/1     Running   0          5m23s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>\u955C\u50CF\u66F4\u65B0</strong></p><p>deployment\u652F\u6301\u4E24\u79CD\u66F4\u65B0\u7B56\u7565:<code>\u91CD\u5EFA\u66F4\u65B0</code>\u548C<code>\u6EDA\u52A8\u66F4\u65B0</code>,\u53EF\u4EE5\u901A\u8FC7<code>strategy</code>\u6307\u5B9A\u7B56\u7565\u7C7B\u578B,\u652F\u6301\u4E24\u4E2A\u5C5E\u6027:</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#C3E88D;">strategy\uFF1A\u6307\u5B9A\u65B0\u7684Pod\u66FF\u6362\u65E7\u7684Pod\u7684\u7B56\u7565\uFF0C \u652F\u6301\u4E24\u4E2A\u5C5E\u6027\uFF1A</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">type\uFF1A\u6307\u5B9A\u7B56\u7565\u7C7B\u578B\uFF0C\u652F\u6301\u4E24\u79CD\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">Recreate\uFF1A\u5728\u521B\u5EFA\u51FA\u65B0\u7684Pod\u4E4B\u524D\u4F1A\u5148\u6740\u6389\u6240\u6709\u5DF2\u5B58\u5728\u7684Pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">RollingUpdate\uFF1A\u6EDA\u52A8\u66F4\u65B0\uFF0C\u5C31\u662F\u6740\u6B7B\u4E00\u90E8\u5206\uFF0C\u5C31\u542F\u52A8\u4E00\u90E8\u5206\uFF0C\u5728\u66F4\u65B0\u8FC7\u7A0B\u4E2D\uFF0C\u5B58\u5728\u4E24\u4E2A\u7248\u672CPod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">rollingUpdate\uFF1A\u5F53type\u4E3ARollingUpdate\u65F6\u751F\u6548\uFF0C\u7528\u4E8E\u4E3ARollingUpdate\u8BBE\u7F6E\u53C2\u6570\uFF0C\u652F\u6301\u4E24\u4E2A\u5C5E\u6027\uFF1A</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">maxUnavailable\uFF1A\u7528\u6765\u6307\u5B9A\u5728\u5347\u7EA7\u8FC7\u7A0B\u4E2D\u4E0D\u53EF\u7528Pod\u7684\u6700\u5927\u6570\u91CF\uFF0C\u9ED8\u8BA4\u4E3A25%\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">maxSurge\uFF1A \u7528\u6765\u6307\u5B9A\u5728\u5347\u7EA7\u8FC7\u7A0B\u4E2D\u53EF\u4EE5\u8D85\u8FC7\u671F\u671B\u7684Pod\u7684\u6700\u5927\u6570\u91CF\uFF0C\u9ED8\u8BA4\u4E3A25%\u3002</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u91CD\u5EFA\u66F4\u65B0</p><ol><li>\u7F16\u8F91pc-deployment.yaml,\u5728spec\u8282\u70B9\u4E0B\u6DFB\u52A0\u66F4\u65B0\u7B56\u7565</li></ol><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">strategy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Recreate</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u91CD\u5EFA\u66F4\u65B0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>\u521B\u5EFAdeploy\u8FDB\u884C\u9A8C\u8BC1</li></ol><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u53D8\u66F4\u955C\u50CF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl set image deployment pc-deployment nginx=nginx:1.17.2 -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment image updated</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u89C2\u5BDF\u5347\u7EA7\u8FC7\u7A0B</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;">#  kubectl get pods -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-65qcw   1/1     Running   0          31s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-w5nzv   1/1     Running   0          31s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-xpt7w   1/1     Running   0          31s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-xpt7w   1/1     Terminating   0          41s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-65qcw   1/1     Terminating   0          41s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-w5nzv   1/1     Terminating   0          41s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-grn8z   0/1     Pending       0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-hbl4v   0/1     Pending       0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-67nz2   0/1     Pending       0          0s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-grn8z   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-hbl4v   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-67nz2   0/1     ContainerCreating   0          0s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-grn8z   1/1     Running             0          1s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-67nz2   1/1     Running             0          1s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b-hbl4v   1/1     Running             0          2s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>\u6EDA\u52A8\u66F4\u65B0</p><ol><li>\u7F16\u8F91pc-deployment.yaml,\u5728spec\u8282\u70B9\u4E0B\u6DFB\u52A0\u66F4\u65B0\u7B56\u7565</li></ol><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">strategy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">RollingUpdate</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rollingUpdate</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">maxSurge</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">25%</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">maxUnavailable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">25%</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>\u521B\u5EFAdeploy\u8FDB\u884C\u9A8C\u8BC1</li></ol><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u53D8\u66F4\u955C\u50CF</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl set image deployment pc-deployment nginx=nginx:1.17.3 -n dev </span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment image updated</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u89C2\u5BDF\u5347\u7EA7\u8FC7\u7A0B</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-8rbzt   1/1     Running   0          31m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-h4p68   1/1     Running   0          31m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-hlmz4   1/1     Running   0          31m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-rrqcn   1/1     Running   0          31m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-226rx   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-226rx   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-226rx   1/1     Running             0          1s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-h4p68    0/1     Terminating         0          34m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-cnd44   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-cnd44   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-cnd44   1/1     Running             0          2s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-hlmz4    0/1     Terminating         0          34m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-px48p   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-px48p   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-px48p   1/1     Running             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-8rbzt    0/1     Terminating         0          34m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-dkmqp   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-dkmqp   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44-dkmqp   1/1     Running             0          2s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767-rrqcn    0/1     Terminating         0          34m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u81F3\u6B64\uFF0C\u65B0\u7248\u672C\u7684pod\u521B\u5EFA\u5B8C\u6BD5\uFF0C\u5C31\u7248\u672C\u7684pod\u9500\u6BC1\u5B8C\u6BD5</span></span>
<span class="line"><span style="color:#676E95;"># \u4E2D\u95F4\u8FC7\u7A0B\u662F\u6EDA\u52A8\u8FDB\u884C\u7684\uFF0C\u4E5F\u5C31\u662F\u8FB9\u9500\u6BC1\u8FB9\u521B\u5EFA</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>\u6EDA\u52A8\u66F4\u65B0\u7684\u8FC7\u7A0B\uFF1A</p><p><img src="`+o+`" alt="img"></p><p>\u955C\u50CF\u66F4\u65B0\u4E2Drs\u7684\u53D8\u5316</p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u67E5\u770Brs,\u53D1\u73B0\u539F\u6765\u7684rs\u7684\u4F9D\u65E7\u5B58\u5728\uFF0C\u53EA\u662Fpod\u6570\u91CF\u53D8\u4E3A\u4E860\uFF0C\u800C\u540E\u53C8\u65B0\u4EA7\u751F\u4E86\u4E00\u4E2Ars\uFF0Cpod\u6570\u91CF\u4E3A4</span></span>
<span class="line"><span style="color:#676E95;"># \u5176\u5B9E\u8FD9\u5C31\u662Fdeployment\u80FD\u591F\u8FDB\u884C\u7248\u672C\u56DE\u9000\u7684\u5965\u5999\u6240\u5728\uFF0C\u540E\u9762\u4F1A\u8BE6\u7EC6\u89E3\u91CA</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78   0         0         0       7m37s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b11   0         0         0       5m37s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d76789   4         4         4       72s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>\u7248\u672C\u56DE\u9000</strong></p><p>deployment\u652F\u6301\u7248\u672C\u5347\u7EA7\u8FC7\u7A0B\u4E2D\u7684\u6682\u505C\u3001\u7EE7\u7EED\u529F\u80FD\u4EE5\u53CA\u7248\u672C\u56DE\u9000\u7B49\u8BF8\u591A\u529F\u80FD\uFF0C\u4E0B\u9762\u5177\u4F53\u6765\u770B.</p><p>kubectl rollout\uFF1A \u7248\u672C\u5347\u7EA7\u76F8\u5173\u529F\u80FD\uFF0C\u652F\u6301\u4E0B\u9762\u7684\u9009\u9879\uFF1A</p><ul><li>status \u663E\u793A\u5F53\u524D\u5347\u7EA7\u72B6\u6001</li><li>history \u663E\u793A \u5347\u7EA7\u5386\u53F2\u8BB0\u5F55</li><li>pause \u6682\u505C\u7248\u672C\u5347\u7EA7\u8FC7\u7A0B</li><li>resume \u7EE7\u7EED\u5DF2\u7ECF\u6682\u505C\u7684\u7248\u672C\u5347\u7EA7\u8FC7\u7A0B</li><li>restart \u91CD\u542F\u7248\u672C\u5347\u7EA7\u8FC7\u7A0B</li><li>undo \u56DE\u6EDA\u5230\u4E0A\u4E00\u7EA7\u7248\u672C\uFF08\u53EF\u4EE5\u4F7F\u7528--to-revision\u56DE\u6EDA\u5230\u6307\u5B9A\u7248\u672C\uFF09</li></ul><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u67E5\u770B\u5F53\u524D\u5347\u7EA7\u7248\u672C\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl rollout status deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-deployment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> successfully rolled out</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770B\u5347\u7EA7\u5386\u53F2\u8BB0\u5F55</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl rollout history deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment</span></span>
<span class="line"><span style="color:#A6ACCD;">REVISION  CHANGE-CAUSE</span></span>
<span class="line"><span style="color:#A6ACCD;">1         kubectl create --filename=pc-deployment.yaml --record=true</span></span>
<span class="line"><span style="color:#A6ACCD;">2         kubectl create --filename=pc-deployment.yaml --record=true</span></span>
<span class="line"><span style="color:#A6ACCD;">3         kubectl create --filename=pc-deployment.yaml --record=true</span></span>
<span class="line"><span style="color:#676E95;"># \u53EF\u4EE5\u53D1\u73B0\u6709\u4E09\u6B21\u7248\u672C\u8BB0\u5F55\uFF0C\u8BF4\u660E\u5B8C\u6210\u8FC7\u4E24\u6B21\u5347\u7EA7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u7248\u672C\u56DE\u6EDA</span></span>
<span class="line"><span style="color:#676E95;"># \u8FD9\u91CC\u76F4\u63A5\u4F7F\u7528--to-revision=1\u56DE\u6EDA\u5230\u4E861\u7248\u672C\uFF0C \u5982\u679C\u7701\u7565\u8FD9\u4E2A\u9009\u9879\uFF0C\u5C31\u662F\u56DE\u9000\u5230\u4E0A\u4E2A\u7248\u672C\uFF0C\u5C31\u662F2\u7248\u672C</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl rollout undo deployment pc-deployment --to-revision=1 -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment rolled back</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770B\u53D1\u73B0\uFF0C\u901A\u8FC7nginx\u955C\u50CF\u7248\u672C\u53EF\u4EE5\u53D1\u73B0\u5230\u4E86\u7B2C\u4E00\u7248</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get deploy -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME            READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES         </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment   4/4     4            4           74m   nginx        nginx:1.17.1   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Brs\uFF0C\u53D1\u73B0\u7B2C\u4E00\u4E2Ars\u4E2D\u67094\u4E2Apod\u8FD0\u884C\uFF0C\u540E\u9762\u4E24\u4E2A\u7248\u672C\u7684rs\u4E2Dpod\u4E3A\u8FD0\u884C</span></span>
<span class="line"><span style="color:#676E95;"># \u5176\u5B9Edeployment\u4E4B\u6240\u4EE5\u53EF\u662F\u5B9E\u73B0\u7248\u672C\u7684\u56DE\u6EDA\uFF0C\u5C31\u662F\u901A\u8FC7\u8BB0\u5F55\u4E0B\u5386\u53F2rs\u6765\u5B9E\u73B0\u7684\uFF0C</span></span>
<span class="line"><span style="color:#676E95;"># \u4E00\u65E6\u60F3\u56DE\u6EDA\u5230\u54EA\u4E2A\u7248\u672C\uFF0C\u53EA\u9700\u8981\u5C06\u5F53\u524D\u7248\u672Cpod\u6570\u91CF\u964D\u4E3A0\uFF0C\u7136\u540E\u5C06\u56DE\u6EDA\u7248\u672C\u7684pod\u63D0\u5347\u4E3A\u76EE\u6807\u6570\u91CF\u5C31\u53EF\u4EE5\u4E86</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6696798b78   4         4         4       78m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-966bf7f44    0         0         0       37m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-c848d767     0         0         0       71m</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>\u91D1\u4E1D\u96C0\u53D1\u5E03</strong></p><p>Deployment\u63A7\u5236\u5668\u652F\u6301\u63A7\u5236\u66F4\u65B0\u8FC7\u7A0B\u4E2D\u7684\u63A7\u5236\uFF0C\u5982\u201C\u6682\u505C(pause)\u201D\u6216\u201C\u7EE7\u7EED(resume)\u201D\u66F4\u65B0\u64CD\u4F5C\u3002</p><p>\u6BD4\u5982\u6709\u4E00\u6279\u65B0\u7684Pod\u8D44\u6E90\u521B\u5EFA\u5B8C\u6210\u540E\u7ACB\u5373\u6682\u505C\u66F4\u65B0\u8FC7\u7A0B\uFF0C\u6B64\u65F6\uFF0C\u4EC5\u5B58\u5728\u4E00\u90E8\u5206\u65B0\u7248\u672C\u7684\u5E94\u7528\uFF0C\u4E3B\u4F53\u90E8\u5206\u8FD8\u662F\u65E7\u7684\u7248\u672C\u3002\u7136\u540E\uFF0C\u518D\u7B5B\u9009\u4E00\u5C0F\u90E8\u5206\u7684\u7528\u6237\u8BF7\u6C42\u8DEF\u7531\u5230\u65B0\u7248\u672C\u7684Pod\u5E94\u7528\uFF0C\u7EE7\u7EED\u89C2\u5BDF\u80FD\u5426\u7A33\u5B9A\u5730\u6309\u671F\u671B\u7684\u65B9\u5F0F\u8FD0\u884C\u3002\u786E\u5B9A\u6CA1\u95EE\u9898\u4E4B\u540E\u518D\u7EE7\u7EED\u5B8C\u6210\u4F59\u4E0B\u7684Pod\u8D44\u6E90\u6EDA\u52A8\u66F4\u65B0\uFF0C\u5426\u5219\u7ACB\u5373\u56DE\u6EDA\u66F4\u65B0\u64CD\u4F5C\u3002\u8FD9\u5C31\u662F\u6240\u8C13\u7684\u91D1\u4E1D\u96C0\u53D1\u5E03\u3002</p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u66F4\u65B0deployment\u7684\u7248\u672C\uFF0C\u5E76\u914D\u7F6E\u6682\u505Cdeployment</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;">#  kubectl set image deploy pc-deployment nginx=nginx:1.17.4 -n dev &amp;&amp; kubectl rollout pause deployment pc-deployment  -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment image updated</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment paused</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">#\u89C2\u5BDF\u66F4\u65B0\u72B6\u6001</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl rollout status deploy pc-deployment -n dev\u3000</span></span>
<span class="line"><span style="color:#A6ACCD;">Waiting </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> deployment </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-deployment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> rollout to finish: 2 out of 4 new replicas have been updated...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u76D1\u63A7\u66F4\u65B0\u7684\u8FC7\u7A0B\uFF0C\u53EF\u4EE5\u770B\u5230\u5DF2\u7ECF\u65B0\u589E\u4E86\u4E00\u4E2A\u8D44\u6E90\uFF0C\u4F46\u662F\u5E76\u672A\u6309\u7167\u9884\u671F\u7684\u72B6\u6001\u53BB\u5220\u9664\u4E00\u4E2A\u65E7\u7684\u8D44\u6E90\uFF0C\u5C31\u662F\u56E0\u4E3A\u4F7F\u7528\u4E86pause\u6682\u505C\u547D\u4EE4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       DESIRED   CURRENT   READY   AGE     CONTAINERS   IMAGES         </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9   3         3         3       19m     nginx        nginx:1.17.1   </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b   0         0         0       14m     nginx        nginx:1.17.2   </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb   2         2         2       3m16s   nginx        nginx:1.17.4   </span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-rj8sq   1/1     Running   0          7m33s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-ttwgg   1/1     Running   0          7m35s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9-v4wvc   1/1     Running   0          7m34s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-996rt   1/1     Running   0          3m31s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-j2gtj   1/1     Running   0          3m31s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u786E\u4FDD\u66F4\u65B0\u7684pod\u6CA1\u95EE\u9898\u4E86\uFF0C\u7EE7\u7EED\u66F4\u65B0</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl rollout resume deploy pc-deployment -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/pc-deployment resumed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770B\u6700\u540E\u7684\u66F4\u65B0\u60C5\u51B5</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get rs -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                       DESIRED   CURRENT   READY   AGE     CONTAINERS   IMAGES         </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-5d89bdfbf9   0         0         0       21m     nginx        nginx:1.17.1   </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-675d469f8b   0         0         0       16m     nginx        nginx:1.17.2   </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb   4         4         4       5m11s   nginx        nginx:1.17.4   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                             READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-7bfwh   1/1     Running   0          37s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-996rt   1/1     Running   0          5m27s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-j2gtj   1/1     Running   0          5m27s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-deployment-6c9f56fcfb-rf84v   1/1     Running   0          37s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><strong>\u5220\u9664Deployment</strong></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u5220\u9664deployment\uFF0C\u5176\u4E0B\u7684rs\u548Cpod\u4E5F\u5C06\u88AB\u5220\u9664</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete -f pc-deployment.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-deployment</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="\u56DB\u3001horizontal-pod-autoscaler-hpa" tabindex="-1">\u56DB\u3001Horizontal Pod Autoscaler(HPA) <a class="header-anchor" href="#\u56DB\u3001horizontal-pod-autoscaler-hpa" aria-hidden="true">#</a></h2><p>\u5728\u524D\u9762\u7684\u8BFE\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u53EF\u4EE5\u5B9E\u73B0\u901A\u8FC7\u624B\u5DE5\u6267\u884C<code>kubectl scale</code>\u547D\u4EE4\u5B9E\u73B0Pod\u6269\u5BB9\u6216\u7F29\u5BB9\uFF0C\u4F46\u662F\u8FD9\u663E\u7136\u4E0D\u7B26\u5408Kubernetes\u7684\u5B9A\u4F4D\u76EE\u6807--\u81EA\u52A8\u5316\u3001\u667A\u80FD\u5316\u3002 Kubernetes\u671F\u671B\u53EF\u4EE5\u5B9E\u73B0\u901A\u8FC7\u76D1\u6D4BPod\u7684\u4F7F\u7528\u60C5\u51B5\uFF0C\u5B9E\u73B0pod\u6570\u91CF\u7684\u81EA\u52A8\u8C03\u6574\uFF0C\u4E8E\u662F\u5C31\u4EA7\u751F\u4E86Horizontal Pod Autoscaler\uFF08HPA\uFF09\u8FD9\u79CD\u63A7\u5236\u5668\u3002</p><p>HPA\u53EF\u4EE5\u83B7\u53D6\u6BCF\u4E2APod\u5229\u7528\u7387\uFF0C\u7136\u540E\u548CHPA\u4E2D\u5B9A\u4E49\u7684\u6307\u6807\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u540C\u65F6\u8BA1\u7B97\u51FA\u9700\u8981\u4F38\u7F29\u7684\u5177\u4F53\u503C\uFF0C\u6700\u540E\u5B9E\u73B0Pod\u7684\u6570\u91CF\u7684\u8C03\u6574\u3002\u5176\u5B9EHPA\u4E0E\u4E4B\u524D\u7684Deployment\u4E00\u6837\uFF0C\u4E5F\u5C5E\u4E8E\u4E00\u79CDKubernetes\u8D44\u6E90\u5BF9\u8C61\uFF0C\u5B83\u901A\u8FC7\u8FFD\u8E2A\u5206\u6790RC\u63A7\u5236\u7684\u6240\u6709\u76EE\u6807Pod\u7684\u8D1F\u8F7D\u53D8\u5316\u60C5\u51B5\uFF0C\u6765\u786E\u5B9A\u662F\u5426\u9700\u8981\u9488\u5BF9\u6027\u5730\u8C03\u6574\u76EE\u6807Pod\u7684\u526F\u672C\u6570\uFF0C\u8FD9\u662FHPA\u7684\u5B9E\u73B0\u539F\u7406\u3002</p><p><img src="`+c+`" alt="img"></p><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u6765\u505A\u4E00\u4E2A\u5B9E\u9A8C</p><p><strong>1 \u5B89\u88C5metrics-server</strong></p><p>metrics-server\u53EF\u4EE5\u7528\u6765\u6536\u96C6\u96C6\u7FA4\u4E2D\u7684\u8D44\u6E90\u4F7F\u7528\u60C5\u51B5</p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u5B89\u88C5git</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># yum install git -y</span></span>
<span class="line"><span style="color:#676E95;"># \u83B7\u53D6metrics-server, \u6CE8\u610F\u4F7F\u7528\u7684\u7248\u672C</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># git clone -b v0.3.6 https://github.com/kubernetes-incubator/metrics-server</span></span>
<span class="line"><span style="color:#676E95;"># \u4FEE\u6539deployment, \u6CE8\u610F\u4FEE\u6539\u7684\u662F\u955C\u50CF\u548C\u521D\u59CB\u5316\u53C2\u6570</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># cd /root/metrics-server/deploy/1.8+/</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># vim metrics-server-deployment.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">\u6309\u56FE\u4E2D\u6DFB\u52A0\u4E0B\u9762\u9009\u9879</span></span>
<span class="line"><span style="color:#A6ACCD;">hostNetwork: </span><span style="color:#82AAFF;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">image: registry.cn-hangzhou.aliyuncs.com/google_containers/metrics-server-amd64:v0.3.6</span></span>
<span class="line"><span style="color:#A6ACCD;">args:</span></span>
<span class="line"><span style="color:#A6ACCD;">- --kubelet-insecure-tls</span></span>
<span class="line"><span style="color:#A6ACCD;">- --kubelet-preferred-address-types=InternalIP,Hostname,InternalDNS,ExternalDNS,ExternalIP</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><img src="`+r+`" alt="image-20200608163326496"></p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u5B89\u88C5metrics-server</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl apply -f ./</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod\u8FD0\u884C\u60C5\u51B5</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl get pod -n kube-system</span></span>
<span class="line"><span style="color:#A6ACCD;">metrics-server-6b976979db-2xwbj   1/1     Running   0          90s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u4F7F\u7528kubectl top node \u67E5\u770B\u8D44\u6E90\u4F7F\u7528\u60C5\u51B5</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl top node</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME           CPU</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cores</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">   CPU%   MEMORY</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bytes</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">   MEMORY%</span></span>
<span class="line"><span style="color:#A6ACCD;">k8s-master01   289m         14%    1582Mi          54%       </span></span>
<span class="line"><span style="color:#A6ACCD;">k8s-node01     81m          4%     1195Mi          40%       </span></span>
<span class="line"><span style="color:#A6ACCD;">k8s-node02     72m          3%     1211Mi          41%  </span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl top pod -n kube-system</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                              CPU</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cores</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">   MEMORY</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bytes</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">coredns-6955765f44-7ptsb          3m           9Mi</span></span>
<span class="line"><span style="color:#A6ACCD;">coredns-6955765f44-vcwr5          3m           8Mi</span></span>
<span class="line"><span style="color:#A6ACCD;">etcd-master                       14m          145Mi</span></span>
<span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#676E95;"># \u81F3\u6B64,metrics-server\u5B89\u88C5\u5B8C\u6210</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>2 \u51C6\u5907deployment\u548Cservie</strong></p><p>\u521B\u5EFApc-hpa-pod.yaml\u6587\u4EF6\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deployment</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">strategy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">RollingUpdate</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">resources</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8D44\u6E90\u914D\u989D</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">limits</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># \u9650\u5236\u8D44\u6E90\uFF08\u4E0A\u9650\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">cpu</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># CPU\u9650\u5236\uFF0C\u5355\u4F4D\u662Fcore\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">requests</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BF7\u6C42\u8D44\u6E90\uFF08\u4E0B\u9650\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">cpu</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">100m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;"># CPU\u9650\u5236\uFF0C\u5355\u4F4D\u662Fcore\u6570</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAservice</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl expose deployment nginx --type=NodePort --port=80 -n dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u67E5\u770B</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl get deployment,pod,svc -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                    READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">deployment.apps/nginx   1/1     1            1           47s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">NAME                         READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pod/nginx-7df9756ccc-bh8dr   1/1     Running   0          47s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">NAME            TYPE       CLUSTER-IP      EXTERNAL-IP   PORT</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">S</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">        AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">service/nginx   NodePort   10.101.18.29   </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">none</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">        80:31830/TCP   35s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>3 \u90E8\u7F72HPA</strong></p><p>\u521B\u5EFApc-hpa.yaml\u6587\u4EF6\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">autoscaling/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HorizontalPodAutoscaler</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-hpa</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">minReplicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">#\u6700\u5C0Fpod\u6570\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">maxReplicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6700\u5927pod\u6570\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">targetCPUUtilizationPercentage</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># CPU\u4F7F\u7528\u7387\u6307\u6807</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">scaleTargetRef</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">   </span><span style="color:#676E95;"># \u6307\u5B9A\u8981\u63A7\u5236\u7684nginx\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deployment</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAhpa</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl create -f pc-hpa.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">horizontalpodautoscaler.autoscaling/pc-hpa created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bhpa</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 1.8+</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;"># kubectl get hpa -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME     REFERENCE          TARGETS   MINPODS   MAXPODS   REPLICAS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa   Deployment/nginx   0%/3%     1         10        1          62s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>4 \u6D4B\u8BD5</strong></p><p>\u4F7F\u7528\u538B\u6D4B\u5DE5\u5177\u5BF9service\u5730\u5740<code>192.168.5.4:31830</code>\u8FDB\u884C\u538B\u6D4B\uFF0C\u7136\u540E\u901A\u8FC7\u63A7\u5236\u53F0\u67E5\u770Bhpa\u548Cpod\u7684\u53D8\u5316</p><p>hpa\u53D8\u5316</p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get hpa -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME   REFERENCE      TARGETS  MINPODS  MAXPODS  REPLICAS  AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  0%/3%   1     10     1      4m11s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  0%/3%   1     10     1      5m19s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  22%/3%   1     10     1      6m50s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  22%/3%   1     10     4      7m5s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  22%/3%   1     10     8      7m21s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  6%/3%   1     10     8      7m51s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  0%/3%   1     10     8      9m6s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  0%/3%   1     10     8      13m</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-hpa  Deployment/nginx  0%/3%   1     10     1      14m</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>deployment\u53D8\u5316</p><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get deployment -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME    READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/1     1            1           11m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/4     1            1           13m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/4     1            1           13m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/4     1            1           13m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/4     4            1           13m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/8     4            1           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/8     4            1           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/8     4            1           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/8     8            1           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   2/8     8            2           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   3/8     8            3           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   4/8     8            4           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   5/8     8            5           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   6/8     8            6           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   7/8     8            7           14m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   8/8     8            8           15m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   8/1     8            8           20m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   8/1     8            8           20m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx   1/1     1            1           20m</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>pod\u53D8\u5316</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">[root@k8s-master01 ~]# kubectl get pods -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                     READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-bh8dr   1/1     Running   0          11m</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-cpgrv   0/1     Pending   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-8zhwk   0/1     Pending   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-rr9bn   0/1     Pending   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-cpgrv   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-8zhwk   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-rr9bn   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-m9gsj   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-g56qb   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-sl9c6   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-fgst7   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-g56qb   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-m9gsj   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-sl9c6   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-fgst7   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-8zhwk   1/1     Running             0          19s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-rr9bn   1/1     Running             0          30s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-m9gsj   1/1     Running             0          21s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-cpgrv   1/1     Running             0          47s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-sl9c6   1/1     Running             0          33s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-g56qb   1/1     Running             0          48s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-fgst7   1/1     Running             0          66s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-fgst7   1/1     Terminating         0          6m50s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-8zhwk   1/1     Terminating         0          7m5s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-cpgrv   1/1     Terminating         0          7m5s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-g56qb   1/1     Terminating         0          6m50s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-rr9bn   1/1     Terminating         0          7m5s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-m9gsj   1/1     Terminating         0          6m50s</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx-7df9756ccc-sl9c6   1/1     Terminating         0          6m50s</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="\u4E94\u3001daemonset-ds" tabindex="-1">\u4E94\u3001DaemonSet(DS) <a class="header-anchor" href="#\u4E94\u3001daemonset-ds" aria-hidden="true">#</a></h2><p>DaemonSet\u7C7B\u578B\u7684\u63A7\u5236\u5668\u53EF\u4EE5\u4FDD\u8BC1\u5728\u96C6\u7FA4\u4E2D\u7684\u6BCF\u4E00\u53F0\uFF08\u6216\u6307\u5B9A\uFF09\u8282\u70B9\u4E0A\u90FD\u8FD0\u884C\u4E00\u4E2A\u526F\u672C\u3002\u4E00\u822C\u9002\u7528\u4E8E\u65E5\u5FD7\u6536\u96C6\u3001\u8282\u70B9\u76D1\u63A7\u7B49\u573A\u666F\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5982\u679C\u4E00\u4E2APod\u63D0\u4F9B\u7684\u529F\u80FD\u662F\u8282\u70B9\u7EA7\u522B\u7684\uFF08\u6BCF\u4E2A\u8282\u70B9\u90FD\u9700\u8981\u4E14\u53EA\u9700\u8981\u4E00\u4E2A\uFF09\uFF0C\u90A3\u4E48\u8FD9\u7C7BPod\u5C31\u9002\u5408\u4F7F\u7528DaemonSet\u7C7B\u578B\u7684\u63A7\u5236\u5668\u521B\u5EFA\u3002</p><p><img src="`+t+`" alt="img"></p><p>DaemonSet\u63A7\u5236\u5668\u7684\u7279\u70B9\uFF1A</p><ul><li>\u6BCF\u5F53\u5411\u96C6\u7FA4\u4E2D\u6DFB\u52A0\u4E00\u4E2A\u8282\u70B9\u65F6\uFF0C\u6307\u5B9A\u7684 Pod \u526F\u672C\u4E5F\u5C06\u6DFB\u52A0\u5230\u8BE5\u8282\u70B9\u4E0A</li><li>\u5F53\u8282\u70B9\u4ECE\u96C6\u7FA4\u4E2D\u79FB\u9664\u65F6\uFF0CPod \u4E5F\u5C31\u88AB\u5783\u573E\u56DE\u6536\u4E86</li></ul><p>\u4E0B\u9762\u5148\u6765\u770B\u4E0BDaemonSet\u7684\u8D44\u6E90\u6E05\u5355\u6587\u4EF6</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7248\u672C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DaemonSet</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7C7B\u578B       </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5143\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># rs\u540D\u79F0 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6240\u5C5E\u547D\u540D\u7A7A\u95F4 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6807\u7B7E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">daemonset</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BE6\u60C5\u63CF\u8FF0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">revisionHistoryLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u4FDD\u7559\u5386\u53F2\u7248\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">updateStrategy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u66F4\u65B0\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">RollingUpdate</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0\u7B56\u7565</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rollingUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6EDA\u52A8\u66F4\u65B0</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">maxUnavailable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6700\u5927\u4E0D\u53EF\u7528\u72B6\u6001\u7684 Pod \u7684\u6700\u5927\u503C\uFF0C\u53EF\u4EE5\u4E3A\u767E\u5206\u6BD4\uFF0C\u4E5F\u53EF\u4EE5\u4E3A\u6574\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u9009\u62E9\u5668\uFF0C\u901A\u8FC7\u5B83\u6307\u5B9A\u8BE5\u63A7\u5236\u5668\u7BA1\u7406\u54EA\u4E9Bpod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">      </span><span style="color:#676E95;"># Labels\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchExpressions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># Expressions\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">operator</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">In</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">nginx-pod</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6A21\u677F\uFF0C\u5F53\u526F\u672C\u6570\u91CF\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u6839\u636E\u4E0B\u9762\u7684\u6A21\u677F\u521B\u5EFApod\u526F\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">containerPort</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>\u521B\u5EFApc-daemonset.yaml\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DaemonSet</span><span style="color:#A6ACCD;">      </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-daemonset</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx:1.17.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAdaemonset</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl create -f  pc-daemonset.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">daemonset.apps/pc-daemonset created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bdaemonset</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;">#  kubectl get ds -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME        DESIRED  CURRENT  READY  UP-TO-DATE  AVAILABLE   AGE   CONTAINERS   IMAGES         </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-daemonset   2        2        2      2           2        24s   nginx        nginx:1.17.1   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod,\u53D1\u73B0\u5728\u6BCF\u4E2ANode\u4E0A\u90FD\u8FD0\u884C\u4E00\u4E2Apod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;">#  kubectl get pods -n dev -o wide</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                 READY   STATUS    RESTARTS   AGE   IP            NODE    </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-daemonset-9bck8   1/1     Running   0          37s   10.244.1.43   node1     </span></span>
<span class="line"><span style="color:#A6ACCD;">pc-daemonset-k224w   1/1     Running   0          37s   10.244.2.74   node2      </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5220\u9664daemonset</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete -f pc-daemonset.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">daemonset.apps </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-daemonset</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="\u516D\u3001job" tabindex="-1">\u516D\u3001Job <a class="header-anchor" href="#\u516D\u3001job" aria-hidden="true">#</a></h2><p>Job\uFF0C\u4E3B\u8981\u7528\u4E8E\u8D1F\u8D23**\u6279\u91CF\u5904\u7406(\u4E00\u6B21\u8981\u5904\u7406\u6307\u5B9A\u6570\u91CF\u4EFB\u52A1)<strong>\u77ED\u6682\u7684</strong>\u4E00\u6B21\u6027(\u6BCF\u4E2A\u4EFB\u52A1\u4EC5\u8FD0\u884C\u4E00\u6B21\u5C31\u7ED3\u675F)**\u4EFB\u52A1\u3002Job\u7279\u70B9\u5982\u4E0B\uFF1A</p><ul><li>\u5F53Job\u521B\u5EFA\u7684pod\u6267\u884C\u6210\u529F\u7ED3\u675F\u65F6\uFF0CJob\u5C06\u8BB0\u5F55\u6210\u529F\u7ED3\u675F\u7684pod\u6570\u91CF</li><li>\u5F53\u6210\u529F\u7ED3\u675F\u7684pod\u8FBE\u5230\u6307\u5B9A\u7684\u6570\u91CF\u65F6\uFF0CJob\u5C06\u5B8C\u6210\u6267\u884C</li></ul><p><img src="`+i+`" alt="img"></p><p>Job\u7684\u8D44\u6E90\u6E05\u5355\u6587\u4EF6\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">batch/v1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7248\u672C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Job</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7C7B\u578B       </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5143\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># rs\u540D\u79F0 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6240\u5C5E\u547D\u540D\u7A7A\u95F4 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6807\u7B7E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">job</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BE6\u60C5\u63CF\u8FF0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">completions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6307\u5B9Ajob\u9700\u8981\u6210\u529F\u8FD0\u884CPods\u7684\u6B21\u6570\u3002\u9ED8\u8BA4\u503C: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">parallelism</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6307\u5B9Ajob\u5728\u4EFB\u4E00\u65F6\u523B\u5E94\u8BE5\u5E76\u53D1\u8FD0\u884CPods\u7684\u6570\u91CF\u3002\u9ED8\u8BA4\u503C: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">activeDeadlineSeconds</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6307\u5B9Ajob\u53EF\u8FD0\u884C\u7684\u65F6\u95F4\u671F\u9650\uFF0C\u8D85\u8FC7\u65F6\u95F4\u8FD8\u672A\u7ED3\u675F\uFF0C\u7CFB\u7EDF\u5C06\u4F1A\u5C1D\u8BD5\u8FDB\u884C\u7EC8\u6B62\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">backoffLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6307\u5B9Ajob\u5931\u8D25\u540E\u8FDB\u884C\u91CD\u8BD5\u7684\u6B21\u6570\u3002\u9ED8\u8BA4\u662F6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">manualSelector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u662F\u5426\u53EF\u4EE5\u4F7F\u7528selector\u9009\u62E9\u5668\u9009\u62E9pod\uFF0C\u9ED8\u8BA4\u662Ffalse</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u9009\u62E9\u5668\uFF0C\u901A\u8FC7\u5B83\u6307\u5B9A\u8BE5\u63A7\u5236\u5668\u7BA1\u7406\u54EA\u4E9Bpod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">      </span><span style="color:#676E95;"># Labels\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchExpressions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># Expressions\u5339\u914D\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">operator</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">In</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">counter-pod</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6A21\u677F\uFF0C\u5F53\u526F\u672C\u6570\u91CF\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u6839\u636E\u4E0B\u9762\u7684\u6A21\u677F\u521B\u5EFApod\u526F\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u91CD\u542F\u7B56\u7565\u53EA\u80FD\u8BBE\u7F6E\u4E3ANever\u6216\u8005OnFailure</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.30</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/sh</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-c</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">for i in 9 8 7 6 5 4 3 2 1; do echo $i;sleep 2;done</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">\u5173\u4E8E\u91CD\u542F\u7B56\u7565\u8BBE\u7F6E\u7684\u8BF4\u660E\uFF1A</span></span>
<span class="line"><span style="color:#A6ACCD;">    \u5982\u679C\u6307\u5B9A\u4E3AOnFailure\uFF0C\u5219job\u4F1A\u5728pod\u51FA\u73B0\u6545\u969C\u65F6\u91CD\u542F\u5BB9\u5668\uFF0C\u800C\u4E0D\u662F\u521B\u5EFApod\uFF0Cfailed\u6B21\u6570\u4E0D\u53D8</span></span>
<span class="line"><span style="color:#A6ACCD;">    \u5982\u679C\u6307\u5B9A\u4E3ANever\uFF0C\u5219job\u4F1A\u5728pod\u51FA\u73B0\u6545\u969C\u65F6\u521B\u5EFA\u65B0\u7684pod\uFF0C\u5E76\u4E14\u6545\u969Cpod\u4E0D\u4F1A\u6D88\u5931\uFF0C\u4E5F\u4E0D\u4F1A\u91CD\u542F\uFF0Cfailed\u6B21\u6570\u52A01</span></span>
<span class="line"><span style="color:#A6ACCD;">    \u5982\u679C\u6307\u5B9A\u4E3AAlways\u7684\u8BDD\uFF0C\u5C31\u610F\u5473\u7740\u4E00\u76F4\u91CD\u542F\uFF0C\u610F\u5473\u7740job\u4EFB\u52A1\u4F1A\u91CD\u590D\u53BB\u6267\u884C\u4E86\uFF0C\u5F53\u7136\u4E0D\u5BF9\uFF0C\u6240\u4EE5\u4E0D\u80FD\u8BBE\u7F6E\u4E3AAlways</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u521B\u5EFApc-job.yaml\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">batch/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Job</span><span style="color:#A6ACCD;">      </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-job</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">manualSelector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.30</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/sh</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-c</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">for i in 9 8 7 6 5 4 3 2 1; do echo $i;sleep 3;done</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl create -f pc-job.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">job.batch/pc-job created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get job -n dev -o wide  -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME     COMPLETIONS   DURATION   AGE   CONTAINERS   IMAGES         SELECTOR</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job   0/1           21s        21s   counter      busybox:1.30   app=counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job   1/1           31s        79s   counter      busybox:1.30   app=counter-pod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u901A\u8FC7\u89C2\u5BDFpod\u72B6\u6001\u53EF\u4EE5\u770B\u5230\uFF0Cpod\u5728\u8FD0\u884C\u5B8C\u6BD5\u4EFB\u52A1\u540E\uFF0C\u5C31\u4F1A\u53D8\u6210Completed\u72B6\u6001</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME           READY   STATUS     RESTARTS      AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-rxg96   1/1     Running     0            29s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-rxg96   0/1     Completed   0            33s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u63A5\u4E0B\u6765\uFF0C\u8C03\u6574\u4E0Bpod\u8FD0\u884C\u7684\u603B\u6570\u91CF\u548C\u5E76\u884C\u6570\u91CF \u5373\uFF1A\u5728spec\u4E0B\u8BBE\u7F6E\u4E0B\u9762\u4E24\u4E2A\u9009\u9879</span></span>
<span class="line"><span style="color:#676E95;">#  completions: 6 # \u6307\u5B9Ajob\u9700\u8981\u6210\u529F\u8FD0\u884CPods\u7684\u6B21\u6570\u4E3A6</span></span>
<span class="line"><span style="color:#676E95;">#  parallelism: 3 # \u6307\u5B9Ajob\u5E76\u53D1\u8FD0\u884CPods\u7684\u6570\u91CF\u4E3A3</span></span>
<span class="line"><span style="color:#676E95;">#  \u7136\u540E\u91CD\u65B0\u8FD0\u884Cjob\uFF0C\u89C2\u5BDF\u6548\u679C\uFF0C\u6B64\u65F6\u4F1A\u53D1\u73B0\uFF0Cjob\u4F1A\u6BCF\u6B21\u8FD0\u884C3\u4E2Apod\uFF0C\u603B\u5171\u6267\u884C\u4E866\u4E2Apod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev -w</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-684ft   1/1     Running   0          5s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-jhj49   1/1     Running   0          5s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-pfcvh   1/1     Running   0          5s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-684ft   0/1     Completed   0          11s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-v7rhr   0/1     Pending     0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-v7rhr   0/1     Pending     0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-v7rhr   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-jhj49   0/1     Completed           0          11s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-fhwf7   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-fhwf7   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-pfcvh   0/1     Completed           0          11s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-5vg2j   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-fhwf7   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-5vg2j   0/1     Pending             0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-5vg2j   0/1     ContainerCreating   0          0s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-fhwf7   1/1     Running             0          2s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-v7rhr   1/1     Running             0          2s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-5vg2j   1/1     Running             0          3s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-fhwf7   0/1     Completed           0          12s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-v7rhr   0/1     Completed           0          12s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-job-5vg2j   0/1     Completed           0          12s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5220\u9664job</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl delete -f pc-job.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">job.batch </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-job</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="\u4E03\u3001cronjob-cj" tabindex="-1">\u4E03\u3001CronJob(CJ) <a class="header-anchor" href="#\u4E03\u3001cronjob-cj" aria-hidden="true">#</a></h2><p>CronJob\u63A7\u5236\u5668\u4EE5Job\u63A7\u5236\u5668\u8D44\u6E90\u4E3A\u5176\u7BA1\u63A7\u5BF9\u8C61\uFF0C\u5E76\u501F\u52A9\u5B83\u7BA1\u7406pod\u8D44\u6E90\u5BF9\u8C61\uFF0CJob\u63A7\u5236\u5668\u5B9A\u4E49\u7684\u4F5C\u4E1A\u4EFB\u52A1\u5728\u5176\u63A7\u5236\u5668\u8D44\u6E90\u521B\u5EFA\u4E4B\u540E\u4FBF\u4F1A\u7ACB\u5373\u6267\u884C\uFF0C\u4F46CronJob\u53EF\u4EE5\u4EE5\u7C7B\u4F3C\u4E8ELinux\u64CD\u4F5C\u7CFB\u7EDF\u7684\u5468\u671F\u6027\u4EFB\u52A1\u4F5C\u4E1A\u8BA1\u5212\u7684\u65B9\u5F0F\u63A7\u5236\u5176\u8FD0\u884C<strong>\u65F6\u95F4\u70B9</strong>\u53CA<strong>\u91CD\u590D\u8FD0\u884C</strong>\u7684\u65B9\u5F0F\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C<strong>CronJob\u53EF\u4EE5\u5728\u7279\u5B9A\u7684\u65F6\u95F4\u70B9(\u53CD\u590D\u7684)\u53BB\u8FD0\u884Cjob\u4EFB\u52A1</strong>\u3002</p><p><img src="`+y+`" alt="img"></p><p>CronJob\u7684\u8D44\u6E90\u6E05\u5355\u6587\u4EF6\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">batch/v1beta1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7248\u672C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CronJob</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u7C7B\u578B       </span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5143\u6570\u636E</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># rs\u540D\u79F0 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u6240\u5C5E\u547D\u540D\u7A7A\u95F4 </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">#\u6807\u7B7E</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cronjob</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u8BE6\u60C5\u63CF\u8FF0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">schedule</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># cron\u683C\u5F0F\u7684\u4F5C\u4E1A\u8C03\u5EA6\u8FD0\u884C\u65F6\u95F4\u70B9,\u7528\u4E8E\u63A7\u5236\u4EFB\u52A1\u5728\u4EC0\u4E48\u65F6\u95F4\u6267\u884C</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">concurrencyPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5E76\u53D1\u6267\u884C\u7B56\u7565\uFF0C\u7528\u4E8E\u5B9A\u4E49\u524D\u4E00\u6B21\u4F5C\u4E1A\u8FD0\u884C\u5C1A\u672A\u5B8C\u6210\u65F6\u662F\u5426\u4EE5\u53CA\u5982\u4F55\u8FD0\u884C\u540E\u4E00\u6B21\u7684\u4F5C\u4E1A</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">failedJobHistoryLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u4E3A\u5931\u8D25\u7684\u4EFB\u52A1\u6267\u884C\u4FDD\u7559\u7684\u5386\u53F2\u8BB0\u5F55\u6570\uFF0C\u9ED8\u8BA4\u4E3A1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">successfulJobHistoryLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u4E3A\u6210\u529F\u7684\u4EFB\u52A1\u6267\u884C\u4FDD\u7559\u7684\u5386\u53F2\u8BB0\u5F55\u6570\uFF0C\u9ED8\u8BA4\u4E3A3</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">startingDeadlineSeconds</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u542F\u52A8\u4F5C\u4E1A\u9519\u8BEF\u7684\u8D85\u65F6\u65F6\u957F</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">jobTemplate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># job\u63A7\u5236\u5668\u6A21\u677F\uFF0C\u7528\u4E8E\u4E3Acronjob\u63A7\u5236\u5668\u751F\u6210job\u5BF9\u8C61;\u4E0B\u9762\u5176\u5B9E\u5C31\u662Fjob\u7684\u5B9A\u4E49</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">completions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">parallelism</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">activeDeadlineSeconds</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">backoffLimit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">manualSelector</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">matchExpressions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">\u89C4\u5219</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">operator</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">In</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">counter-pod</span><span style="color:#89DDFF;">]}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter-pod</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.30</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/sh</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-c</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">for i in 9 8 7 6 5 4 3 2 1; do echo $i;sleep 20;done</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#C3E88D;">\u9700\u8981\u91CD\u70B9\u89E3\u91CA\u7684\u51E0\u4E2A\u9009\u9879\uFF1A</span></span>
<span class="line"><span style="color:#F07178;">schedule</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cron\u8868\u8FBE\u5F0F\uFF0C\u7528\u4E8E\u6307\u5B9A\u4EFB\u52A1\u7684\u6267\u884C\u65F6\u95F4</span></span>
<span class="line"><span style="color:#A6ACCD;">    *</span><span style="color:#C3E88D;">/1    *      *    *     *</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">&lt;\u5206\u949F&gt; &lt;\u5C0F\u65F6&gt; &lt;\u65E5&gt; &lt;\u6708\u4EFD&gt; &lt;\u661F\u671F&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u5206\u949F \u503C\u4ECE 0 \u5230 59.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u5C0F\u65F6 \u503C\u4ECE 0 \u5230 23.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u65E5 \u503C\u4ECE 1 \u5230 31.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u6708 \u503C\u4ECE 1 \u5230 12.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u661F\u671F \u503C\u4ECE 0 \u5230 6, 0 \u4EE3\u8868\u661F\u671F\u65E5</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">\u591A\u4E2A\u65F6\u95F4\u53EF\u4EE5\u7528\u9017\u53F7\u9694\u5F00\uFF1B \u8303\u56F4\u53EF\u4EE5\u7528\u8FDE\u5B57\u7B26\u7ED9\u51FA\uFF1B*\u53EF\u4EE5\u4F5C\u4E3A\u901A\u914D\u7B26\uFF1B /\u8868\u793A\u6BCF...</span></span>
<span class="line"><span style="color:#F07178;">concurrencyPolicy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Allow</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">\u5141\u8BB8Jobs\u5E76\u53D1\u8FD0\u884C(\u9ED8\u8BA4)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Forbid</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">\u7981\u6B62\u5E76\u53D1\u8FD0\u884C\uFF0C\u5982\u679C\u4E0A\u4E00\u6B21\u8FD0\u884C\u5C1A\u672A\u5B8C\u6210\uFF0C\u5219\u8DF3\u8FC7\u4E0B\u4E00\u6B21\u8FD0\u884C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Replace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">\u66FF\u6362\uFF0C\u53D6\u6D88\u5F53\u524D\u6B63\u5728\u8FD0\u884C\u7684\u4F5C\u4E1A\u5E76\u7528\u65B0\u4F5C\u4E1A\u66FF\u6362\u5B83</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u521B\u5EFApc-cronjob.yaml\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-yaml line-numbers-mode"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">batch/v1beta1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CronJob</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pc-cronjob</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">controller</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cronjob</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">schedule</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*/1 * * * *</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">jobTemplate</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">counter</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.30</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bin/sh</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-c</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">for i in 9 8 7 6 5 4 3 2 1; do echo $i;sleep 3;done</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-shell line-numbers-mode"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#676E95;"># \u521B\u5EFAcronjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl create -f pc-cronjob.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">cronjob.batch/pc-cronjob created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bcronjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get cronjobs -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME         SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob   </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">/1 </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">   False     0        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">none</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">          6s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get jobs -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                    COMPLETIONS   DURATION   AGE</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587800   1/1           28s        3m26s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587860   1/1           28s        2m26s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587920   1/1           28s        86s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770Bpod</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl get pods -n dev</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587800-x4tsm   0/1     Completed   0          2m24s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587860-r5gv4   0/1     Completed   0          84s</span></span>
<span class="line"><span style="color:#A6ACCD;">pc-cronjob-1592587920-9dxxq   1/1     Running     0          24s</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5220\u9664cronjob</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@k8s-master01 </span><span style="color:#89DDFF;">~]</span><span style="color:#676E95;"># kubectl  delete -f pc-cronjob.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">cronjob.batch </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pc-cronjob</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> deleted</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div>`,121),b=[C];function A(m,F,u,d,E,g){return a(),n("div",null,b)}const k=s(D,[["render",A]]);export{R as __pageData,k as default};
